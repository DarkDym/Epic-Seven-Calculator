(function(N,O){function V(d,h,u){Object.defineProperty(d,h,{writable:!1,configurable:!1,value:u})}"undefined"===typeof BPLR.AdSDK&&(BPLR.AdSDK={});var la=(O.BPLRIframeBurst?N.top:N).document;BPLR.AdSDK.Util={urlParts:function(d){var h=O.createElement("a");h.setAttribute("href",d);return{href:h.href,protocol:h.protocol?h.protocol.replace(/:$/,""):"",host:h.host,search:h.search?h.search.replace(/^\?/,""):"",hash:h.hash?h.hash.replace(/^#/,""):"",hostname:h.hostname,port:h.port?h.port:80,pathname:"/"===
h.pathname.charAt(0)?h.pathname:"/"+h.pathname}},queryStringToObj:function(d,h){h=z.isFunction(h)?h:function(){return!0};d=d.trim().replace(/^\?/,"");d=d.split("&");var u={};d.forEach(function(y){if(""!==y){var G=y.split("=");y=G[0];G=G[1];h(y,G)&&(u[y]=G)}});return u},objToQueryString:function(d){var h=[];d.forEach(function(u,y){h.push(y+"="+u)});return h.join("&")},itemFromQueryString:function(d,h){h||(h=location.href);d=d.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");d=(new RegExp("[\\?&]"+d+"=([^&#]*)")).exec(h);
return null==d?null:d[1]},isArray:function(d){return"[object Array]"===Object.prototype.toString.call(d)},isFunction:function(d){return"[object Function]"==Object.prototype.toString.call(d)},decapitalize:function(d){return d.charAt(0).toLowerCase()+d.slice(1)},transformArray:function(d,h){var u=[];d.forEach(function(y,G){(y=h(y,G))&&u.push(y)});return u},timeouts:{},callbackTimeout:function(d,h,u){d=setTimeout(function(){h=function(){};delete z.timeouts[y];u()},d);var y=function(){h.apply(this,arguments)&&
z.clearCallbackTimeout(y)};y.uniqueNum=parseInt(1E4*Math.random());z.timeouts[y.uniqueNum]=d;return y},clearCallbackTimeout:function(d){var h=z.timeouts[d.uniqueNum];h&&(clearTimeout(h),delete z.timeouts[d.uniqueNum])},checkIfURLExists:function(d){try{var h=N.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");h.open("HEAD",d,!1);h.onload=function(){};h.onerror=function(u){};h.send();return 404!==h.status&&403!==h.status}catch(u){return!1}},getOGG:function(d,h,u,y,G){for(var H,
I="",J=0,a=d.length;J<a;J++)if(-1!=d[J].type.indexOf("video")&&("video/mp4"==d[J].type||h)){H=d[J];-1<H.src.indexOf("youtube.com")&&(I=z.itemFromQueryString("video_id",H.src));d="string"==typeof u.adSystem?u.adSystem.toLocaleLowerCase():u.adSystem.toString();h=u.adTitle||"";u=((-1!=d.indexOf("gdfp")||-1!=d.indexOf("google")||-1!=d.indexOf("dcm")||-1!=d.indexOf("dart")||-1!=d.indexOf("freewheel")?d:u.id)+"_"+(u.creativeID||h.replace(/ /g,""))+"_"+I).replace(/\//g,"");G=y?"264":G;y="//cdn.brid.tv/live/partners/"+
G+"/mobile/"+encodeURIComponent(u)+".ogg";z.checkIfURLExists(y)?(H.mp3=y.replace("ogg","mp3").replace("mobile","mp3"),H.src=y,H.type="video/ogg"):(G="//apiunits.brid.tv/oggs/get/"+G+"/"+u+"/"+btoa(H.src)+".json",BPLR.Loader.loadText(G,function(f){},function(f){}),H=!0);break}return H},VAST:{track:function(d,h){var u=[];F.parseURLMacros(d,h).forEach(function(y){var G=new Image;G.src=y;u.push(G)});return u},parseURLMacros:function(d,h){var u=[];h=h||{};h.CACHEBUSTING||(h.CACHEBUSTING=Math.round(1E10*
Math.random()));"undefined"!=typeof d&&d.forEach(function(y){u.push(F._parseURLMacro(y,h))});return u},parseURLMacro:function(d,h){h=h||{};h.CACHEBUSTING||(h.CACHEBUSTING=Math.round(1E10*Math.random()));return F._parseURLMacro(d,h)},_parseURLMacro:function(d,h){h=h||{};w.eachProp(h,function(u,y){d=d.replace(new RegExp("\\["+u+"\\]","gm"),y)});return d},parseTimeString:function(d){var h=/(\d):(\d):(\d)(\.(\d\d\d))?/,u=/(\d\d):(\d\d):(\d\d)(\.(\d\d\d))?/,y;"string"===typeof d&&(h=d.match(h))&&(y=3600*
parseInt("0"+h[1],10)+60*parseInt("0"+h[2],10)+parseInt("0"+h[3],10));"string"===typeof d&&(h=d.match(u))&&(y=3600*parseInt(h[1],10)+60*parseInt(h[2],10)+parseInt(h[3],10)+parseInt(h[5]||0)/1E3);return isNaN(y)?null:y},parseImpressions:function(d){return d?(d=z.isArray(d)?d:[d],z.transformArray(d,function(h){if(h.keyValue)return h.keyValue})):[]},parseViewableImpressions:function(d){return d?(d=z.isArray(d)?d:[d],z.transformArray(d,function(h){if(h.keyValue)return h.keyValue})):[]},parseCreatives:function(d){var h=
[];d&&d.creative&&(d=z.isArray(d.creative)?d.creative:[d.creative],d.forEach(function(u){h.push(new ma(u))}));return h},parseAdVerifications:function(d){var h=[];d&&d.verification&&(d=z.isArray(d.verification)?d.verification:[d.verification],d.forEach(function(u){h.push(new ea(u))}));return h},parseExtensions:function(d){var h=[];d&&d.extension&&(d=z.isArray(d.extension)?d.extension:[d.extension],d.forEach(function(u){"AdVerifications"==u.attr("type")?h=h.concat(z.VAST.parseAdVerifications(u.adVerifications)):
h.push(new na(u))}));return h},parseTrackingEvents:function(d,h){var u=[];d&&(d=z.isArray(d)?d:[d],d.forEach(function(y){u.push(new oa(y,h))}));return u},formatProgress:function(d){var h=Math.floor(d/36E5);var u=Math.floor(d/6E4%60);var y=Math.floor(d/1E3%60);d%=1E3;return w.round(h,2)+":"+w.round(u,2)+":"+w.round(y,2)+"."+w.round(d,3)},parseOffset:function(d,h){return/^\d+(\.\d+)?%$/g.test(d)?(h?(d=parseFloat(d.replace("%","")),h=h*d/100):h=null,h):F.parseTimeString(d)},VPAID_techs:[],isVPAID:function(d){return!!d&&
"VPAID"===d.apiFramework},findSupportedVPAIDTech:function(d){var h;var u=0;for(h=F.VPAID_techs.length;u<h;u+=1){var y=F.VPAID_techs[u];if(y.supports(d))return y}return null}},async:{setImmediate:function(d){setTimeout(d,0)},iterator:function(d){var h=function(u){var y=function(){d.length&&d[u].apply(null,arguments);return y.next()};y.next=function(){return u<d.length-1?h(u+1):null};return y};return h(0)},waterfall:function(d,h){h=h||function(){};if(!z.isArray(d))return h(Error("First argument to waterfall must be an array of functions"));
if(!d.length)return h();var u=function(y){return function(G){if(G)h.apply(null,arguments),h=function(){};else{var H=Array.prototype.slice.call(arguments,1),I=y.next();I?H.push(u(I)):H.push(h);aa.setImmediate(function(){y.apply(null,H)})}}};u(aa.iterator(d))()}},basync:{setImmediate:function(d){setTimeout(d,0)},iterator:function(d){var h=function(u){var y=function(){d.length&&d[u].apply(null,arguments);return y.next()};y.next=function(){return u<d.length-1?h(u+1):null};return y};return h(0)},waterfall:function(d,
h){h=h||function(){};if(!z.isArray(d))return h(Error("First argument to waterfall must be an array of functions"));if(!d.length)return h();var u=function(y){return function(G){if(G)h.apply(null,arguments),h=function(){};else{var H=Array.prototype.slice.call(arguments,1),I=y.next();I?H.push(u(I)):H.push(h);y.apply(null,H)}}};u(R.iterator(d))()}},checkIframeSound:function(d,h){var u=(d.contentDocument?d.contentDocument:d.contentWindow.document).createElement("video");u.setAttribute("webkit-playsinline",
"");u.setAttribute("playsinline","");u.playing=!1;u.autoplay=!0;u.muted=!1;u.src="data:video/mp4;base64,AAAAFGZ0eXBNU05WAAACAE1TTlYAAAOUbW9vdgAAAGxtdmhkAAAAAM9ghv7PYIb+AAACWAAACu8AAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAnh0cmFrAAAAXHRraGQAAAAHz2CG/s9ghv4AAAABAAAAAAAACu8AAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAFAAAAA4AAAAAAHgbWRpYQAAACBtZGhkAAAAAM9ghv7PYIb+AAALuAAANq8AAAAAAAAAIWhkbHIAAAAAbWhscnZpZGVBVlMgAAAAAAABAB4AAAABl21pbmYAAAAUdm1oZAAAAAAAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAVdzdGJsAAAAp3N0c2QAAAAAAAAAAQAAAJdhdmMxAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAFAAOABIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAAEmNvbHJuY2xjAAEAAQABAAAAL2F2Y0MBTUAz/+EAGGdNQDOadCk/LgIgAAADACAAAAMA0eMGVAEABGjuPIAAAAAYc3R0cwAAAAAAAAABAAAADgAAA+gAAAAUc3RzcwAAAAAAAAABAAAAAQAAABxzdHNjAAAAAAAAAAEAAAABAAAADgAAAAEAAABMc3RzegAAAAAAAAAAAAAADgAAAE8AAAAOAAAADQAAAA0AAAANAAAADQAAAA0AAAANAAAADQAAAA0AAAANAAAADQAAAA4AAAAOAAAAFHN0Y28AAAAAAAAAAQAAA7AAAAA0dXVpZFVTTVQh0k/Ou4hpXPrJx0AAAAAcTVREVAABABIAAAAKVcQAAAAAAAEAAAAAAAAAqHV1aWRVU01UIdJPzruIaVz6ycdAAAAAkE1URFQABAAMAAAAC1XEAAACHAAeAAAABBXHAAEAQQBWAFMAIABNAGUAZABpAGEAAAAqAAAAASoOAAEAZABlAHQAZQBjAHQAXwBhAHUAdABvAHAAbABhAHkAAAAyAAAAA1XEAAEAMgAwADAANQBtAGUALwAwADcALwAwADYAMAA2ACAAMwA6ADUAOgAwAAABA21kYXQAAAAYZ01AM5p0KT8uAiAAAAMAIAAAAwDR4wZUAAAABGjuPIAAAAAnZYiAIAAR//eBLT+oL1eA2Nlb/edvwWZflzEVLlhlXtJvSAEGRA3ZAAAACkGaAQCyJ/8AFBAAAAAJQZoCATP/AOmBAAAACUGaAwGz/wDpgAAAAAlBmgQCM/8A6YEAAAAJQZoFArP/AOmBAAAACUGaBgMz/wDpgQAAAAlBmgcDs/8A6YEAAAAJQZoIBDP/AOmAAAAACUGaCQSz/wDpgAAAAAlBmgoFM/8A6YEAAAAJQZoLBbP/AOmAAAAACkGaDAYyJ/8AFBAAAAAKQZoNBrIv/4cMeQ==";
u.load();u=u.play();void 0!==u&&u.then(function(){BPLR.log(h+" AUTOPLAY IFRAME DESKTOP ALLOWED");d.soundAllowed=!0}).catch(function(){BPLR.log(h+" AUTOPLAY IFRAME DESKTOP NOT NOT ALLOWED")})}};var w=BPLR.Util,Q=BPLR.event,z=BPLR.AdSDK.Util,F=z.VAST,aa=z.async,R=z.basync,Y=w.$f;BPLR.AdSDK.XML={strToXMLDoc:function(d){var h=new DOMParser,u=!1;try{u=d.firstChild}catch(G){}if(u)return d;try{var y=h.parseFromString(d,"application/xml");if(!d)throw Error();}catch(G){throw Error("xml.strToXMLDOC: Error parsing the string: '"+
d+"'");}return y},isISO8601:function(d){isNaN(d)||(d+="");return"string"!=typeof d?!1:/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/.test(w.trim(d))},parseText:function(d){return/^\s*$/.test(d)?null:/^(?:true|false)$/i.test(d)?"true"===d.toLowerCase():isFinite(d)?
parseFloat(d):B.isISO8601(d)?new Date(d):w.trim(d)},toJXONTree:function(d){d=B.strToXMLDoc(d);return new B.JXONTree(d)},keyValue:function(d){if(d)return d.keyValue},attr:function(d,h){if(d)return d["@"+z.decapitalize(h)]},encode:function(d){return d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},decode:function(d){return d.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")}};
var B=BPLR.AdSDK.XML;B.JXONTree=function(d){if(d.documentElement)return new B.JXONTree(d.documentElement);if(d.hasChildNodes()){for(var h="",u,y,G=0;G<d.childNodes.length;G++)(u=d.childNodes.item(G),3===(u.nodeType-1|1))?h+=3===u.nodeType?w.trim(u.nodeValue):u.nodeValue:1!==u.nodeType||u.prefix?1===u.nodeType&&"vmap"==u.prefix&&(y=z.decapitalize(u.nodeName.replace("vmap:","")),u=new B.JXONTree(u),this.hasOwnProperty(y)?(z.isArray(this[y])||(this[y]=[this[y]]),this[y].push(u)):this[y]=u):(y=z.decapitalize(u.nodeName),
u=new B.JXONTree(u),this.hasOwnProperty(y)?(z.isArray(this[y])||(this[y]=[this[y]]),this[y].push(u)):this[y]=u);h&&(this.keyValue=B.parseText(h))}if("undefined"===typeof d.hasAttributes?0<d.attributes.length:d.hasAttributes())for(y=0;y<d.attributes.length;y++)h=d.attributes.item(y),this["@"+z.decapitalize(h.name)]=B.parseText(h.value.trim())};B.JXONTree.prototype.attr=function(d){return this["@"+z.decapitalize(d)]};var fa=BPLR.Button.extend({enabled:!1,timePosition:0,default:{title:"Skip Ad"},init:function y(h,
u){h.config.translate&&h.config.translate.skip_ad&&(this.default.title=h.config.translate.skip_ad);y.base.call(this,h,u);h.add("timeupdate",this.$f(this.updateSkipButtonState));this.toggleListeners(!1)},createElement:function u(){return u.base.call(this,"div",{className:"bplr-iab-skip-button bplr-button"})},onClick:function(){this.enabled&&this.trigger("skip")},updateSkipButtonState:function(){var u=this.player.currentTime(),y=Math.ceil(this.config.skipOffset-u);5<u-this.timePosition||(this.timePosition=
u,this.el.style.display="block",0<y?this.el.innerHTML=(this.player.config.translate&&this.player.config.translate.skip_in||"SKIP IN").toUpperCase()+" "+Math.round(y)+"...":this.enabled||(this.toggleListeners(!0),this.enabled=!0,this.el.innerHTML=this.default.title.toUpperCase()))},destroy:function y(){this.player.remove("timeupdate",this.$f(this.updateSkipButtonState));y.base.call(this)}}),ha=BPLR.Sprite.extend({enabled:!1,init:function I(G,H){I.base.call(this,G,H);this.el.href=this.generateClickThroughURL(H.clickThrough,
H.mediaFile.src);"string"===typeof H.clickThrough&&(this.el.target="_blank");this.add("click",this.$f(this.onClick))},createElement:function H(){return H.base.call(this,"a",{className:"bplr-iab-blocker"})},onClick:function(){this.player.trigger("adClicked");this.trigger("clickthrough")},generateClickThroughURL:function(H,I){I={ASSETURI:I,CONTENTPLAYHEAD:F.formatProgress(1E3*this.player.currentTime())};return H?F.parseURLMacro(H,I):"#"}}),pa=ha.extend({enabled:!1,init:function a(I,J){a.base.call(this,
I,J)},createElement:function(){var I=w.createElement("a",{className:"bplr-static-container"});-1!=this.config.mediaFile.type.indexOf("image/")&&(this.image=w.createElement("img",{src:this.config.mediaFile.src}),this.image.onload=this.$f(function(){this.trigger("loaded")}),I.appendChild(this.image));return I},resize:function(I,J,a,f){this.el.style.top=I+"px";this.el.style.left=J+"px";this.el.style.width=a+"px";this.el.style.height=f+"px";this.el.style.setProperty("display","block","important")}}),
ba={html5:"text/javascript text/javascript1.0 text/javascript1.2 text/javascript1.4 text/jscript application/javascript application/x-javascript text/ecmascript text/ecmascript1.0 text/ecmascript1.2 text/ecmascript1.4 text/livescript application/ecmascript application/x-ecmascript".split(" ")},S=BPLR.PlaybackTech.extend({init:function(I){this.config=I;this.name="AdSDK.VideoSlot";this.el=this.createElement();this.hide();this.triggerReady()},destroy:function(){this.el.parentNode.removeChild(this.el)},
createElement:function(){var I=this.config,J=w.createElement("video",{id:I.id,className:"bplr-tech"});J.preload="none";w.autoplaySupported&&I.autoplay&&(J.setAttribute("muted","true"),J.muted=!0);I.muted&&(J.muted=!0,J.volume=0);w.css(J,{"background-color":"#000"});J.setAttribute("webkit-playsinline","");J.setAttribute("playsinline","");return J},hide:function J(){J.base.call(this)},show:function a(){a.base.call(this)},play:function(){this.el.play()},pause:function(){this.el.pause()},paused:function(){return this.el.paused},
currentTime:function(){return this.el.currentTime},setCurrentTime:function(a){try{this.el.currentTime=a}catch(f){BPLR.warn("--- BPLRPlayer --- Video isn't ready. ",f)}},duration:function(){return this.el.duration||0},buffered:function(){return this.el.buffered},volume:function(){return this.el.volume},setVolume:function(a){this.el.volume=a},muted:function(){return this.el.muted},setMuted:function(a){a||this.el.removeAttribute("muted");this.el.muted=a},src:function(a){this.el.src=a},removeSrc:function(){this.el.removeAttribute("src")},
load:function(){this.el.load()},currentSrc:function(){return this.el.src},preload:function(){return this.el.preload},setPreload:function(a){this.el.preload=a},autoplay:function(){return this.el.autoplay},setAutoplay:function(a){this.el.autoplay=a},loop:function(){return this.el.loop},setLoop:function(a){this.el.loop=a},error:function(){switch(this.el.error.code){case 1:return"Fetching process aborted by user";case 2:return"Error occurred when downloading";case 3:return"Error occurred when decoding";
case 4:return"Audio/video not supported"}return!1},networkState:function(){return this.el.networkState},readyState:function(){return this.el.readyState},seeking:function(){return this.el.seeking},ended:function(){return this.el.ended},defaultMuted:function(){return this.el.defaultMuted}});S.isSupported=function(){return!!O.createElement("video").canPlayType};S.canPlaySource=function(a){return(a=w.formatType(a.src,a.type))?O.createElement("video").canPlayType?!!O.createElement("video").canPlayType(a):
!1:!1};S.canPlayURL=function(a){return(a=w.getTypeFromFile(a))?O.createElement("video").canPlayType?!!O.createElement("video").canPlayType(a):!1:!1};S.events="loadstart suspend abort error emptied stalled loadedmetadata loadeddata canplay canplaythrough playing waiting seeking seeked ended durationchange timeupdate progress play pause ratechange volumechange webkitbeginfullscreen webkitendfullscreen".split(" ");S.prototype.support={fullscreen:w.ua.match("Chrome")||w.ua.match("Mac OS X 10.5")?!1:!0,
movingElementInDOM:!w.isIOS(),progressEvent:!0,timeupdateEvent:!0,monetizable:!0,adManagement:!1,canResize:!0,hasPoster:!1,qualityManager:!1};w.isAndroid()&&3>w.androidVersion()&&(O.createElement("video").constructor.prototype.canPlayType=function(a){return a&&-1!=a.toLowerCase().indexOf("video/mp4")?"maybe":""});var ia=BPLR.Class.extend({init:function(a){this.id=a.attr("id");this.sequence=a.attr("sequence");a.inLine&&(this.inLine=new qa(a.inLine));a.wrapper&&(this.wrapper=new ra(a.wrapper))}}),ma=
BPLR.Class.extend({init:function(a){this.id=a.attr("id");this.sequence=a.attr("sequence");this.adId=a.attr("adId")||a.attr("adID");this.apiFramework=a.attr("apiFramework");a.linear?this.linear=new sa(a.linear):a.nonLinearAds&&(this.nonLinearAds=new ta(a.nonLinearAds))}}),na=BPLR.Class.extend({init:function(a){this.type=a.attr("type");a.customTracking&&a.customTracking.tracking&&(this.trackingEvents=F.parseTrackingEvents(a.customTracking.tracking))}}),qa=BPLR.Class.extend({init:function(a){this.adTitle=
B.keyValue(a.adTitle);this.adSystem=B.keyValue(a.adSystem);this.adServingId=B.keyValue(a.adServingId);this.impressions=F.parseImpressions(a.impression);a.viewableImpression&&(this.viewableImpression=F.parseViewableImpressions(a.viewableImpression.viewable));this.creatives=F.parseCreatives(a.creatives);this.adVerifications=F.parseAdVerifications(a.adVerifications);this.description=B.keyValue(a.description);this.advertiser=B.keyValue(a.advertiser);this.surveys=function(f){return f?z.transformArray(z.isArray(f)?
f:[f],function(v){if(v.keyValue)return{uri:v.keyValue,type:v.attr("type")}}):[]}(a.survey);this.error=B.keyValue(a.error);this.pricing=B.keyValue(a.pricing);a.extensions&&(this.extensions=F.parseExtensions(a.extensions),this.extensions.forEach(function(f){f instanceof ea&&this.adVerifications.push(f)},this))}}),sa=BPLR.Class.extend({init:function(a){this.duration=F.parseTimeString(B.keyValue(a.duration));this.mediaFiles=function(f){var v=[];f&&(f=z.isArray(f)?f:[f],f.forEach(function(x){x=new ua(x);
-1==x.type.indexOf("video/3gp")&&v.push(x)}));return v}(a.mediaFiles&&a.mediaFiles.mediaFile);this.interactiveCreativeFile=function(f){if(!f)return!1;var v=[];f=z.isArray(f)?f:[f];f.forEach(function(x){v.push(new va(x))});return v}(a.mediaFiles&&a.mediaFiles.interactiveCreativeFile);this.trackingEvents=F.parseTrackingEvents(a.trackingEvents&&a.trackingEvents.tracking,this.duration);this.skipoffset=F.parseOffset(B.attr(a,"skipoffset"),this.duration);a.videoClicks&&(this.videoClicks=new wa(a.videoClicks));
a.adParameters&&(this.adParameters=B.keyValue(a.adParameters),B.attr(a.adParameters,"xmlEncoded")&&(this.adParameters=B.decode(this.adParameters)))}}),ta=BPLR.Class.extend({init:function(a){this.trackingEvents=F.parseTrackingEvents(a.trackingEvents&&a.trackingEvents.tracking);a.nonLinear&&(this.nonLinear=new xa(a.nonLinear))}}),xa=BPLR.Class.extend({init:function(a){a.staticResource&&(this.type=a.staticResource.attr("creativeType"),this.src=B.keyValue(a.staticResource));this.clickThrough=B.keyValue(a.nonLinearClickThrough);
this.clickTrackings=function(f){var v=[];f&&(f=z.isArray(f)?f:[f],f.forEach(function(x){v.push(B.keyValue(x))}));return v}(a.nonLinearClickTracking);this.width=a.attr("width");this.height=a.attr("height");this.minSuggestedDuration=a.attr("minSuggestedDuration");this.apiFramework=a.attr("apiFramework");this.id=a.attr("id");this.scalable=a.attr("scalable");this.maintainAspectRatio=a.attr("maintainAspectRatio")}}),va=BPLR.Class.extend({init:function(a){this.src=B.keyValue(a);this.type="application/javascript";
this.apiFramework="VPAID"}}),ua=BPLR.Class.extend({init:function(a){this.src=B.keyValue(a);this.delivery=a.attr("delivery");this.type=a.attr("type");this.width=a.attr("width");this.height=a.attr("height");this.codec=a.attr("codec");this.id=a.attr("id");this.bitrate=a.attr("bitrate");this.minBitrate=a.attr("minBitrate");this.maxBitrate=a.attr("maxBitrate");this.scalable=a.attr("scalable");this.maintainAspectRatio=a.attr("maintainAspectRatio");this.apiFramework=a.attr("apiFramework")}}),oa=BPLR.Class.extend({init:function(a,
f){this.name=a.attr("event");this.uri=B.keyValue(a);"progress"===this.name&&(this.offset=F.parseOffset(a.attr("offset"),f))}}),wa=BPLR.Class.extend({init:function(a){function f(v){var x=[];v&&(v=z.isArray(v)?v:[v],v.forEach(function(D){void 0!==B.keyValue(D)&&x.push(B.keyValue(D))}));return x}this.clickThrough=B.keyValue(a.clickThrough);this.clickTrackings=f(a.clickTracking);this.customClicks=f(a.customClick)}}),ra=BPLR.Class.extend({init:function(a){this.adSystem=B.keyValue(a.adSystem);this.impressions=
F.parseImpressions(a.impression);this.VASTAdTagURI=B.keyValue(a.vASTAdTagURI);this.creatives=F.parseCreatives(a.creatives);this.error=B.keyValue(a.error);this.extensions=a.extensions;this.followAdditionalWrappers="undefined"!=typeof B.attr(a,"followAdditionalWrappers")?B.attr(a,"followAdditionalWrappers"):!0;this.allowMultipleAds=B.attr(a,"allowMultipleAds");this.fallbackOnNoAd=B.attr(a,"fallbackOnNoAd")}}),ea=BPLR.Class.extend({init:function(a){this.vendor=a.attr("vendor");a.javaScriptResource&&
(this.apiFramework=a.javaScriptResource.attr("apiFramework"),this.browserOptional=a.javaScriptResource.attr("browserOptional")||!1,this.javaScriptResource=B.keyValue(a.javaScriptResource));a.trackingEvents&&(this.trackingEvents=F.parseTrackingEvents(a.trackingEvents));if(a.verificationParameters)try{this.verificationParameters=JSON.parse(B.keyValue(a.verificationParameters))}catch(f){this.verificationParameters=w.queryStringToObj(B.keyValue(a.verificationParameters))}}}),ja=BPLR.Class.extend({init:function(a){this.breakId=
a.attr("breakId");this.breakType=a.attr("breakType");this.timeOffset=a.attr("timeOffset");-1!=this.timeOffset.indexOf(":")&&(this.timeOffset=z.VAST.parseTimeString(this.timeOffset));this.played=!1;if(a.adSource||a.ad)this.adSource=new ya(a.adSource||a.ad);a.trackingEvents&&(this.trackingEvents=F.parseTrackingEvents(a.trackingEvents))}}),ya=BPLR.Class.extend({init:function(a){a.adTagURI||a.vastAdData||a.customData?(this.id=a.attr("id"),this.allowMultipleAds=a.attr("allowMultipleAds"),this.followRedirects=
a.attr("followRedirects"),a.adTagURI&&(this.adTagURI=B.keyValue(a.adTagURI),this.templateType=a.adTagURI.attr("templateType")),a.vastAdData&&(this.vastAdData=B.keyValue(a.vastAdData),this.templateType="vast3"),a.customData&&(this.customData=B.keyValue(a.customData),this.templateType=a.adTagURI.attr("templateType"))):this.adTagURI=B.keyValue(a)}}),E=function(a,f,v){this.message="BPLR AdSDK VAST Error: "+(a||"")+" "+(f||"");v&&(this.data=v);f&&(this.code=f)};E.prototype=Error();E.prototype.name="VAST Error";
var W=BPLR.Class.extend({events:[],init:function(a,f){this.response=f;this.assetURI=a;this.progress=0;this.quartiles={firstQuartile:{tracked:!1,time:Math.round(25*f.duration)/100*1E3},midpoint:{tracked:!1,time:Math.round(50*f.duration)/100*1E3},thirdQuartile:{tracked:!1,time:Math.round(75*f.duration)/100*1E3}}},trackURLs:function(a,f){z.isArray(a)&&0<a.length&&(f=w.merge({ASSETURI:this.assetURI,CONTENTPLAYHEAD:F.formatProgress(this.progress)},f||{}),F.track(a,f))},trackEvent:function(a,f,v){v=v||
this.response;var x=function(D){if(D){var A=[];D.forEach(function(g){A.push(g.uri)})}return A}(v.trackingEvents[a]);this.trackURLs(x);f&&delete v.trackingEvents[a]},addTrackEvent:function(a,f,v){this.response.trackingEvents[a]&&v&&this.events.push({name:a,trackOnce:!!f})},addQuartileEvents:function(a){var f=this.quartiles.midpoint,v=this.quartiles.thirdQuartile;this.quartiles.firstQuartile.tracked?f.tracked?v.tracked||this.trackQuartile("thirdQuartile",a):this.trackQuartile("midpoint",a):this.trackQuartile("firstQuartile",
a)},trackQuartile:function(a,f){var v=this.quartiles[a],x=v.time;f>=x&&f<=x+5E3&&(Q.trigger(this,a),v.tracked=!0,this.addTrackEvent(a,!0,!0))},directTrackQuartile:function(a,f){if(f=this.quartiles[a])f.tracked=!0,this.trackEvent(a,!0)},trackProgressEvents:function(a){var f=this.response.trackingEvents;if(z.isArray(f.progress)){var v=[];f.progress.forEach(Y(this,function(x){1E3*x.offset<=a?this.trackURLs([x.uri]):v.push(x)}));f.progress=v}},trackEvents:function(){this.events.forEach(function(a){this.trackEvent(a.name,
a.trackOnce)},this)},trackStart:function(){this.trackEvent("start",!0)},trackPause:function(){this.trackEvent("pause")},trackResume:function(){this.trackEvent("resume")},trackSkip:function(){this.trackEvent("skip",!0)},trackFullscreen:function(){this.trackEvent("fullscreen",!0)},trackExitFullscreen:function(){this.trackEvent("exitFullscreen",!0)},trackProgress:function(a,f){this.events=[];if(!isNaN(a)){this.addTrackEvent("start",!0,0<a);var v=this.progress;this.addTrackEvent.call(this,"rewind",!1,
v>a&&3E3<Math.abs(a-v));f||this.addQuartileEvents(a);this.trackProgressEvents(a);this.trackEvents();this.progress=a}},trackComplete:function(){this.quartiles.thirdQuartile.tracked&&this.trackEvent("complete",!0)},trackErrorWithCode:function(a){isNaN(a)||this.trackURLs(this.response.errorURLMacros,{ERRORCODE:a})},trackImpressions:function(){this.trackURLs(this.response.impressions)},trackViewableImpressions:function(){this.trackURLs(this.response.viewableImpressions)},trackCreativeView:function(){this.trackEvent("creativeView")},
trackClick:function(){this.trackURLs(this.response.clickTrackings)}});"rewind fullscreen exitFullscreen pause resume mute unmute acceptInvitation acceptInvitationLinear collapse expand".split(" ").forEach(function(a){W.prototype["track"+w.uc(a)]=function(){this.trackEvent(a)}});["start","skip","close","closeLinear"].forEach(function(a){W.prototype["track"+w.uc(a)]=function(){this.trackEvent(a,!0)}});["firstQuartile","midpoint","thirdQuartile"].forEach(function(a){W.prototype["track"+w.uc(a)]=function(){this.quartiles[a].tracked=
!0;this.trackEvent(a,!0)}});var za=BPLR.Class.extend({init:function(){this.nonLinearAdded=this.linearAdded=!1;this.nonLinear=void 0;this.ads=[];this.errorURLMacros=[];this.impressions=[];this.viewableImpressions=[];this.clickTrackings=[];this.customClicks=[];this.trackingEvents={};this.mediaFiles=[];this.interactiveCreativeFile=[];this.extensions=[];this.adVerifications=[];this.clickThrough=void 0;this.adSystem=this.creativeID=this.id=this.adServingId=this.adTitle="";this.skipoffset=this.duration=
void 0},addAd:function(a){if(a instanceof ia){var f=a.inLine;var v=a.wrapper;this.ads.push(a);f&&this._addInLine(f);v&&this._addWrapper(v);this._addID(a.id)}},_addErrorTrackUrl:function(a){(a=a instanceof B.JXONTree?B.keyValue(a):a)&&this.errorURLMacros.push(a)},_addImpressions:function(a){z.isArray(a)&&w.appendToArray(this.impressions,a)},_addViewableImpressions:function(a){z.isArray(a)&&w.appendToArray(this.viewableImpressions,a)},_addClickThrough:function(a){a&&(this.clickThrough=a)},_addClickTrackings:function(a){z.isArray(a)&&
w.appendToArray(this.clickTrackings,a)},_addCustomClicks:function(a){z.isArray(a)&&w.appendToArray(this.customClicks,a)},_addTrackingEvents:function(a){var f=this.trackingEvents;a&&(a=z.isArray(a)?a:[a],a.forEach(function(v){f[v.name]||(f[v.name]=[]);f[v.name].push(v)}))},_addTitle:function(a){a&&(this.adTitle=a)},_addID:function(a){a&&(this.id=a)},_addServingId:function(a){a&&(this.adServingId=a)},_addAdSystem:function(a){this.adSystem=a},_addCreativeID:function(a){a&&(this.creativeID=a)},_addDuration:function(a){isNaN(a)||
(this.duration=a)},_addVideoClicks:function(a){a&&(this._addClickThrough(a.clickThrough),this._addClickTrackings(a.clickTrackings),this._addCustomClicks(a.customClicks))},_addMediaFiles:function(a){z.isArray(a)&&w.appendToArray(this.mediaFiles,a)},_addInteractiveCreativeFile:function(a){z.isArray(a)&&w.appendToArray(this.interactiveCreativeFile,a)},_addSkipoffset:function(a){a&&(this.skipoffset=a)},_addNonLinear:function(a){a&&(this.nonLinear=a,this._addClickThrough(a.clickThrough),this._addClickTrackings(a.clickTrackings))},
_addAdParameters:function(a){a&&(this.adParameters=a)},_addLinear:function(a){this._addDuration(a.duration);this._addTrackingEvents(a.trackingEvents);this._addVideoClicks(a.videoClicks);this._addMediaFiles(a.mediaFiles);this._addInteractiveCreativeFile(a.interactiveCreativeFile);this._addSkipoffset(a.skipoffset);this._addAdParameters(a.adParameters);this.linearAdded=!0},_addNonLinearAds:function(a){this._addTrackingEvents(a.trackingEvents);this._addNonLinear(a.nonLinear);this.nonLinearAdded=!0},_addExtensions:function(a){a.forEach(Y(this,
function(f){"activeview"==f.type&&f.trackingEvents&&this._addTrackingEvents(f.trackingEvents)}))},_addVerifications:function(a){a&&(this.adVerifications=a)},_addInLine:function(a){this._addTitle(a.adTitle);this._addServingId(a.adServingId);this._addErrorTrackUrl(a.error);this._addImpressions(a.impressions);this._addViewableImpressions(a.viewableImpression);this._addVerifications(a.adVerifications);a.adSystem&&this._addAdSystem(a.adSystem);a.extensions&&this._addExtensions(a.extensions);a.creatives.forEach(Y(this,
function(f){f.linear?(this._addLinear(f.linear),this._addCreativeID(f.id||f.adId)):f.nonLinearAds&&this._addNonLinearAds(f.nonLinearAds)}))},_addWrapper:function(a){this._addErrorTrackUrl(a.error);this._addImpressions(a.impressions);a.creatives.forEach(Y(this,function(f){if(f=f.linear)this._addVideoClicks(f.videoClicks),this.clickThrough=void 0,this._addTrackingEvents(f.trackingEvents)}))},hasLinear:function(){return this.linearAdded}}),Aa=BPLR.Class.extend({init:function(){this.adBreaks=[]},addAdBreak:function(a){a instanceof
ja&&this.adBreaks.push(a)},prerollAdBreaks:function(){var a=[];this.adBreaks.map(function(f){f.played||0!=f.timeOffset&&"start"!=f.timeOffset&&"0%"!=f.timeOffset||a.push(f)});return 0<a.length?a:null},postrollAdBreaks:function(){var a=[];this.adBreaks.map(function(f){f.played||"end"!=f.timeOffset&&"100%"!=f.timeOffset||a.push(f)});return 0<a.length?a:null},midrollAdBreaks:function(){var a=[];this.adBreaks.map(function(f){var v=f.timeOffset;!f.played&&"end"!=v&&"100%"!=v&&0<v&&"start"!=v&&"0%"!=v&&
a.push(f)});return 0<a.length?a:null},hasLinear:function(){return!0}}),Ba=BPLR.Sprite.extend({default:{responseTimeout:15E3,adsEnabled:!0},init:function g(f,v,x,D,A){g.base.call(this,f,D,A);this.playbackTech=x;this.viewMode="normal";this.adsManager=v;this.container=A;this.adsCanceled=!1},playAd:function(f){var v;if(!this.adsCanceled){f||this.trackError(new E("On AdsManager, missing required VASTResponse"),f);f.linearAdded?v=[function(D){D(null,f)},this.$f(this._selectAdSource),this.$f(this._createVASTTracker),
this.$f(this._addClickThrough),this.$f(this._addSkipButton),this.$f(this._addEvents),this.$f(this._playSelectedAd)]:f.nonLinearAdded&&(v=[function(D){D(null,f)},this.$f(this._selectAdSource),this.$f(this._createVASTTracker),this.$f(this._addEvents),this.$f(this._playSelectedAd)]);aa.waterfall(v,this.$f(function(D,A){D&&A?this.trackError(D,A):this.adsManager.isLinear()&&(this.adsManager.trigger("vast.adVideoComplete"),this.adsManager.trigger("vast.contentResumeRequested"),this.adsManager.trigger("vast.adEnd"))}));
var x=this;return this._adUnit={_src:null,type:"VAST",pauseAd:function(){x.playbackTech.pause()},resumeAd:function(){x.playbackTech.play()},isPaused:function(){return x.playbackTech.paused()},getSrc:function(){return this._src},getWidth:function(){return this._width},getHeight:function(){return this._height}}}},stopAd:function(){this.adsManager.trigger("vast.adEnd")},reset:function(){this.adsCanceled=!0;this.adsLoader=null},_selectAdSource:function(f,v){var x=this.player.el.offsetWidth;if(f.linearAdded){f.mediaFiles.sort(function(m,
e){return Math.abs(x-m.width)-Math.abs(x-e.width)});for(var D=0,A=f.mediaFiles.length;D<A;D++){var g=f.mediaFiles[D];w.formatType(g.src,g.type);if(S.canPlaySource(g))if(w.isAndroid()&&"application/x-mpegURL"==g.type)g=null;else break;g=null}}else f.nonLinearAdded&&x>=f.nonLinear.width&&(g=f.nonLinear);if(g&&1!=g)return g.duration=f.duration,this._adUnit&&(this._adUnit._src=g.src,this._adUnit._width=g.width,this._adUnit._height=g.height),v(null,g,f);f.linearAdded?v(new E("Could not find Ad mediafile supported by this player",
403),f):f.nonLinearAdded&&v(new E("Player to small for non linear ad to display",403),f)},_createVASTTracker:function(f,v,x){try{this.tracker=new W(f.src,v),x(null,f,this.tracker,v)}catch(D){x(D,v)}},_addEvents:function(f,v,x,D){function A(){.1>Math.abs(n.duration())-n.currentTime()||(v.trackPause(),w.isMobilePlatform()||w.autoplayDesktopSupported||w.isAutoplayDesktopSupported(),this.adsManager.trigger("vast.adPause"),n.addOnce("play",this.$f(function(){v.trackResume();this.adsManager.trigger("vast.adResume")})))}
function g(){var b=1E3*n.currentTime();v.trackProgress(b)}function m(){var b=n.muted();b?v.trackMute():k&&v.trackUnmute();k=b}function e(b){this.adsManager.trigger("vast."+b.type)}var k,n=this.playbackTech;x.linearAdded&&(n.add("pause",this.$f(A)),n.add("volumechange",m),n.add("timeupdate",g),Q.add(v,["firstQuartile","midpoint","thirdQuartile"],this.$f(e)));this.adsManager.addOnce("vast.adStart",this.$f(function(){v.trackImpressions();v.trackCreativeView();this.adsManager.trigger("vast.adImpression")}));
this.adsManager.addOnce(["vast.adEnd","vast.adsCancel","vast.adSkip"],this.$f(function(b){n.remove("pause",A);n.remove("timeupdate",g);n.remove("volumechange",m);n!=this.player.tech&&(n.src(""),n.hide());"vast.adEnd"===b.type&&v.trackComplete()}));return D(null,f,x)},_addSkipButton:function(f,v,x,D){function A(){g&&(this.removeChild(g),g.destroy(),g=null)}if((!x.nonLinearAdded||x.linearAdded)&&!isNaN(x.skipoffset)){var g=new fa(this.player,{skipOffset:x.skipoffset});g.add("skip",this.$f(function(){v.trackSkip();
this.adsManager.trigger("vast.adSkip")}));this.addChild(g);this.adsManager.addOnce(["vast.adEnd","vast.adsCancel","vast.adSkip"],this.$f(A))}D(null,f,v,x)},_addClickThrough:function(f,v,x,D){var A=this.playbackTech,g=new ha(this.player,{clickThrough:x.clickThrough,mediaFile:f});g.add("clickthrough",function(){v.trackClick();if(A.paused())return A.play(),!1;A.pause()});this.addChild(g);this.adsManager.addOnce(["vast.adEnd","vast.adsCancel","vast.adSkip"],this.$f(function(){g&&(this.removeChild(g),
g.destroy(),g=null)}));return D(null,f,v,x)},_playSelectedAd:function(f,v,x){function D(){g.remove(["play","playing"],this.$f(D));m.trigger("vast.adStart")}var A=this.player,g=this.playbackTech,m=this.adsManager;if(v.linearAdded)m.trigger("vast.contentPauseRequested"),g.show(),g.addOnce(["loadedmetadata","error"],this.$f(function(k){if("loadedmetadata"===k.type){var n=this.$f(function(){m.remove("vast.adSkip",n);g.remove("ended",b);x(null,v)});m.add("vast.adSkip",n);var b=this.$f(function(){m.remove("vast.adSkip",
n);g.remove("ended",b);x(null,v)});g.add("ended",b);g.addOnce(["play","playing"],this.$f(D));g.play()}else"error"===k.type&&x(new E("on VASTManager, Player is unable to play the Ad",400),v)})),g.src(f.src),A.canAutoplay()||A.userInteracted?g.load():x(new E("Playback attempted without user interaction on environment that does not support video playback without user interaction"),v);else if(v.nonLinearAdded){var e=this.nonLinear=new pa(A,{clickThrough:v.clickThrough,mediaFile:f});e.add("loaded",this.$f(function(){m.trigger("vast.adStart")}));
this.addChild(e);m.trigger("vast.contentResumeRequested");m.addOnce(["vast.adEnd","vast.adsCancel"],this.$f(function(){e&&(this.removeChild(e),e.destroy(),this.nonLinear=e=null)}))}},getAdDuration:function(){return this.playbackTech.duration()},getAdCurrentTime:function(){return this.playbackTech.currentTime()},setAdVolume:function(f){BPLR.log("AdSDK VAST setAdVolume",f,BPLR.Util.autoplayDesktopSupported,"player autoplay",this.player.config.autoplay);w.isMobilePlatform()||BPLR.Util.autoplayDesktopSupported||
!this.player.config.autoplay||(f=0,BPLR.log("AdSDK VAST setAdVolume",f));this.playbackTech.setVolume(f);this.playbackTech.setMuted(!f)},getAdVolume:function(){return this.playbackTech.volume()},stop:function(){this.adsManager.trigger("vast.contentResumeRequested");this.adsManager.trigger("vast.adSkip")},resize:function(f,v,x,D,A){this.nonLinear&&this.nonLinear.resize(f,v,x,D);this.tracker&&this.viewMode!==A&&(this.viewMode=A,"fullscreen"===A?this.tracker.trackFullscreen():this.tracker.trackExitFullscreen())},
trackError:function(f,v){this.tracker?this.tracker.trackErrorWithCode(f.code||900):v&&F.track(v.errorURLMacros,{ERRORCODE:f.code||900});this.adsManager.adError(f,v)},addChild:function x(v){x.base.call(this,v);this.container.appendChild(v.el)},removeChild:function D(x){x.el&&this.container.removeChild(x.el);D.base.call(this,x)}}),X="handshakeVersion initAd startAd stopAd skipAd resizeAd pauseAd resumeAd expandAd collapseAd subscribe unsubscribe".split(" "),P=BPLR.Class.extend({init:function(x,D,A){},
handshakeVersion:function(x,D){},initAd:function(x,D,A,g,m,e,k){},startAd:function(x){},stopAd:function(x){},skipAd:function(x){},resizeAd:function(x,D,A,g){},pauseAd:function(x){},resumeAd:function(x){},expandAd:function(x){},collapseAd:function(x){},add:function(x,D,A){},remove:function(x,D){},removeAll:function(){Q.removeAll(this)},getAdLinear:function(x){},getAdWidth:function(x){},getAdHeight:function(x){},getAdExpanded:function(x){},getAdSkippableState:function(x){},getAdRemainingTime:function(x){},
getAdDuration:function(x){},getAdVolume:function(x){},getAdCompanions:function(x){},getAdIcons:function(x){},setAdVolume:function(x,D){},addClass:function(x){w.addClass(this.el,x)},$f:function(x,D){return w.$f(this,x,D)}});V(P,"METHODS",X);V(P,"GETTERS","getAdLinear getAdWidth getAdHeight getAdExpanded getAdSkippableState getAdRemainingTime getAdDuration getAdVolume getAdCompanions getAdIcons".split(" "));V(P,"SETTERS",["setAdVolume"]);V(P,"EVENTS","AdLoaded AdStarted AdStopped AdSkipped AdSkippableStateChange AdSizeChange AdLinearChange AdDurationChange AdExpandedChange AdRemainingTimeChange AdVolumeChange AdImpression AdVideoStart AdVideoFirstQuartile AdVideoMidpoint AdVideoThirdQuartile AdVideoComplete AdInteraction AdUserAcceptInvitation AdUserMinimize AdUserClose AdPaused AdPlaying AdLog AdError".split(" "));
var Ca=X.filter(function(x){return-1===["skipAd"].indexOf(x)});V(P,"checkVPAIDInterface",function(x){return Ca.every(function(D){return"function"===typeof x[D]})});BPLR.Sprite.extend({default:{},init:function m(D,A,g){m.base.call(this,D,A);this.response=A.response;this.vpaidManager=g;this.id="fakeVideoElement"},createElement:function A(){var g=A.base.call(this,"div",{src:"#"});g.HAVE_NOTHING=0;g.HAVE_METADATA=1;g.HAVE_CURRENT_DATA=2;g.HAVE_FUTURE_DATA=3;g.HAVE_ENOUGH_DATA=4;g.NETWORK_EMPTY=0;g.NETWORK_IDLE=
1;g.NETWORK_LOADING=2;g.NETWORK_NO_SOURCE=3;g.src="#";g.currentSrc="#";g.currentTime=0;g.buffered=w.createTimeRange(0,0);g.played=w.createTimeRange(0,0,0);g.volume=null;g.muted=null;g.duration=1;g.load=this.$f(this.load);g.play=this.$f(this.play);g.pause=this.$f(this.pause);g.readyState=0;g.ended=!1;g.paused=!1;w.css(g,{width:"100%",height:"100%"});g.canPlayType=function(m){return"video/mp4"==m?"probably":""};g.requestFullscreen=function(){};return g},load:function(){if(!this.videoPlaying){var A=
this.player,g=this.el,m;"undefined"!=typeof g&&g&&(m="#"!=g.src?g.src:g.getAttribute("src"))&&"#"!=m&&(m={src:m,type:-1!=m.indexOf("youtube.com")?"video/mp4":w.getTypeFromFile(m)},(m=z.getOGG([m],!0,this.response,A.adsManager.flagOurAd,A.config.Partner.id))&&1!=m?(A.adsManager.trigger("vast.selected3rdParty"),this.videoPlaying=!0,A.add("play",this.$f(this.onFakeEvent)),A.add("playing",this.$f(this.onFakeEvent)),A.add("pause",this.$f(this.onFakeEvent)),A.add("ended",this.$f(this.onFakeEvent)),A.add("loadedmetadata",
this.$f(this.onFakeEvent)),A.add("timeupdate",this.$f(this.onFakeEvent)),A.add("loadstart",this.$f(this.onFakeEvent)),A.add("waiting",this.$f(this.onFakeEvent)),A.add("progress",this.$f(this.onFakeEvent)),A.add("durationchange",this.$f(this.onFakeEvent)),A.add("volumechange",this.$f(this.onFakeEvent)),A.techCall("src",m),A.techCall("load"),A.techCall("play"),g.ended=!1,g.paused=!1,g.duration=A.techGet("duration"),g.readyState=1):this.vpaidManager._trackError(new E("Could not find Ad mediafile supported by this player",
403),this.response))}},play:function(){var A=this.player;this.videoPlaying?A.techCall("play"):this.load()},pause:function(){this.videoPlaying&&this.player.techCall("pause")},setVolume:function(A){this.player.techCall("setVolume",A)},onFakeEvent:function(A){if(this.el){var g=this.el,m=this.player;switch(A.type){case "progress":g.buffered=m.techGet("buffered");2>g.readyState?g.readyState=2:3>g.readyState&&(g.readyState=3);break;case "loadedmetadata":g.readyState=4;g.duration=m.techGet("duration");break;
case "timeupdate":g.currentTime=m.techGet("currentTime")||1;null!=g.volume&&g.volume!=m.techGet("volume")?this.player.techCall("setVolume",g.volume):null!=g.muted&&g.muted!=m.techGet("muted")&&this.player.techCall("setMuted",g.muted);break;case "play":g.duration=m.techGet("duration");g.paused=!1;break;case "pause":g.paused=!0;break;case "volumechange":g.volume=m.techGet("volume");break;case "ended":g.currentTime=g.duration,g.ended=!0,this.videoPlaying=!1}N.CustomEvent&&(A=new CustomEvent(A.type,{detail:{},
bubbles:!1,cancelable:!0}),g.dispatchEvent(A))}},destroy:function g(){var m=this.player;m.remove("play",this.$f(this.onFakeEvent));m.remove("playing",this.$f(this.onFakeEvent));m.remove("pause",this.$f(this.onFakeEvent));m.remove("ended",this.$f(this.onFakeEvent));m.remove("loadedmetadata",this.$f(this.onFakeEvent));m.remove("timeupdate",this.$f(this.onFakeEvent));m.remove("loadstart",this.$f(this.onFakeEvent));m.remove("waiting",this.$f(this.onFakeEvent));m.remove("progress",this.$f(this.onFakeEvent));
m.remove("durationchange",this.$f(this.onFakeEvent));m.remove("volumechange",this.$f(this.onFakeEvent));this.el&&(this.el.load=function(){},this.el.play=function(){},this.el.pause=function(){});g.base.call(this)}});var Z=BPLR.Class.extend({default:{},init:function(g,m){if(!g||!Z.checkVPAIDInterface(g))throw new E("on VPAIDUnitWrapper, the passed VPAID adUnit does not fully implement the VPAID interface");if("object"!=typeof m)throw new E("on VPAIDUnitWrapper, expected config hash but got '"+m+"'");
if(!("responseTimeout"in m)||"number"!=typeof m.responseTimeout)throw new E("on VPAIDUnitWrapper, expected responseTimeout in options");this.config=m;this._adUnit=g},add:function(g,m){(this._adUnit.addEventListener||this._adUnit.subscribe||this._adUnit.on||this._adUnit.add).call(this._adUnit,g,m)},remove:function(g,m){(this._adUnit.removeEventListener||this._adUnit.unsubscribe||this._adUnit.off||this._adUnit.remove).call(this._adUnit,g,m)},trigger:function(g){this._adUnit.trigger(g)},handshakeVersion:function(g,
m){this._adUnit.handshakeVersion(g,m)},initAd:function(g,m,e,k,n,b,c){this._adUnit.initAd(g,m,e,k,n,b,c)},resizeAd:function(g,m,e,k){this._adUnit.resizeAd(g,m,e,k)},startAd:function(g,m){this._adUnit.startAd(g,m)},stopAd:function(g){this._adUnit.stopAd(g)},pauseAd:function(g){this._adUnit.pauseAd(g)},resumeAd:function(g){this._adUnit.resumeAd(g)},expandAd:function(g){this._adUnit.expandAd(g)},collapseAd:function(g){this._adUnit.collapseAd(g)},skipAd:function(g){this._adUnit.skipAd(g)},setAdVolume:function(g,
m){this._adUnit.setAdVolume(g,m)}});Z.checkVPAIDInterface=function(g){function m(b){return z.isFunction(b.unsubscribe)||z.isFunction(b.removeEventListener)||z.isFunction(b.off)||z.isFunction(b.remove)}for(var e="handshakeVersion initAd startAd stopAd resizeAd pauseAd expandAd collapseAd".split(" "),k=0,n=e.length;k<n;k++)if(!g||!z.isFunction(g[e[k]]))return!1;return function(b){return z.isFunction(b.subscribe)||z.isFunction(b.addEventListener)||z.isFunction(b.on)||z.isFunction(b.add)}(g)&&m(g)};"adLinear adWidth adHeight adExpanded adSkippableState adRemainingTime adDuration adVolume adCompanions adIcons".split(" ").forEach(function(g){var m=
"get"+w.uc(g);Z.prototype[m]=function(e){this._adUnit[m](e)}});var T=P.extend({init:function c(m,e,k,n,b){c.base.call(this,m,e,k);if(this.isValid=P.checkVPAIDInterface(m))this._creative=m,this.container=e,this.player=b,this._videoEl=k,this._iframe=n,this.addClass("bplr-tech"),this._addEvents(),this.isVpaidVideoElementUsed=!1},initAd:function(m,e,k,n,b,c,p){b=b||{};c=w.merge({slot:this.container,videoSlot:this._videoEl,videoSlotCanAutoPlay:!0},c||{});try{this._creative.initAd(m,e,k,n,b,c)}catch(l){var q=
l}p(q)},startAd:function(m,e){e&&w.autoplaySupported&&(e=this.container.getElementsByTagName("video"),Array.prototype.forEach.call(e,function(n){n.setAttribute("muted","");n.muted=!0;n.setAttribute("autoplay","");n.autoplay=!0}));try{this._creative.startAd()}catch(n){var k=n}m(k)},resizeAd:function(m,e,k,n){w.css(this.container,{width:m+"px",height:e+"px"});try{this._creative.resizeAd(m,e,k)}catch(c){var b=c}n(b)},add:function(m,e){Q.add(this,m,e)},remove:function(m,e){Q.remove(this,m,e)},trigger:function(m,
e,k){return Q.trigger(this,m,e,k)},removeAll:function(){Q.removeAll(this)},setAdVolume:function(m,e){BPLR.log("VPAIDHtml5AdUnit setAdVolume this.isVpaidVideoElementUsed",this.isVpaidVideoElementUsed);BPLR.log("VPAIDHtml5AdUnit setAdVolume this._videoEl.src ",this._videoEl.src);BPLR.log("VPAIDHtml5AdUnit setAdVolume this._videoEl.muted ",this._videoEl.muted);BPLR.log("VPAIDHtml5AdUnit setAdVolume this._videoEl.volume ",this._videoEl.volume);if(""==this._videoEl.src&&!this.isVpaidVideoElementUsed){BPLR.log("VPAIDHtml5AdUnit ad video element unknown ABORT");
try{var k=this._creative.getAdVolume();BPLR.log("VPAIDHtml5AdUnit ad video element unknown ABORT result",k)}catch(b){console.log(b)}BPLR.log("VPAIDHtml5AdUnit ad video element unknown ABORT volume",m);if(0<m){BPLR.log("VPAIDHtml5AdUnit ad video element unknown ABORT RETURN");return}}""==this._videoEl.src&&this.isVpaidVideoElementUsed&&(BPLR.log("VPAIDHtml5AdUnit setAdVolume iframe.soundAllowed",this._iframe.soundAllowed,this._videoEl.src),w.isMobilePlatform()||this._iframe.soundAllowed||(m=0),w.isAndroid()&&
!this._iframe.soundAllowed&&(BPLR.log("VPAIDHtml5AdUnit ANDROID setAdVolume iframe.soundAllowed",this._iframe.soundAllowed,this._videoEl.src),m=0));var n=null;BPLR.log("VPAIDHtml5AdUnit setAdVolume",m);try{this._creative.setAdVolume(m),k=this._creative.getAdVolume()}catch(b){n=b}BPLR.log("VPAIDHtml5AdUnit setAdVolume result",k);n||k!=m&&(n="failed to apply volume: "+m);e&&e(n,k)},destroy:function(){this.stopAd();this.removeAll();this._removeEvents();this._iframe=this._videoEl=this.container=this._creative=
null},_addEvents:function(){BPLR.log("VPAIDHtml5AdUnit _addEvents",this._videoEl,this.player,w.hasTouch());P.EVENTS.forEach(function(n){this._creative.subscribe(this.trigger.bind(this,n),n)}.bind(this));this._creative.subscribe(this.$f(this._clickThruHook),"AdClickThru");if(this._videoEl){var m=this._iframe.contentDocument.documentElement,e=this._videoEl,k=this.player;m.addEventListener("click",function(n){n.target===m&&e.click()});k&&w.hasTouch()&&m.addEventListener("touchstart",function(n){BPLR.log("VPAIDHtml5AdUnit touchstart");
k.mouseOver()})}},_removeEvents:function(){P.EVENTS.forEach(function(m){this._creative.unsubscribe(this.trigger.bind(this,m),m)}.bind(this));this._creative.unsubscribe(this.$f(this._clickThruHook),"AdClickThru")},_clickThruHook:function(m,e,k){Q.trigger(this,"AdClickThru",{url:m,id:e,playerHandles:k})}});P.METHODS.forEach(function(m){-1==="add remove subscribe unsubscribe initAd startAd resizeAd".split(" ").indexOf(m)&&(T.prototype[m]=function(){var e=P.prototype[m].length,k=Array.prototype.slice.call(arguments);
e=k&&e===k.length?k.pop():void 0;var n=null;try{var b=this._creative[m].apply(this._creative,k)}catch(c){n=c}e&&"function"==typeof e&&e(n,b)})});P.GETTERS.forEach(function(m){T.prototype[m]=function(e){var k=null;try{var n=this._creative[m]()}catch(b){k=b}e&&"function"==typeof e&&e(k,n)}});T.prototype.on=T.prototype.add;T.prototype.off=T.prototype.remove;N.MutationObserver=N.MutationObserver||N.WebKitMutationObserver||N.MozMutationObserver;X=BPLR.Class.extend({default:{template:'<!DOCTYPE html><html style="padding:0px;height:100%;width:100%;background:transparent;" lang="en"><head><meta charset="UTF-8"></head><body style="overflow:hidden;margin:0px;padding:0px;height:100%;width:100%;max-width:100%;" onload="console.log(\'BODY LOADED\');"></body></html>',
timeout:15E3},init:function(m,e,k){BPLR.log("FIRE VPAIDHtml5Tech init",(new Date).getTime());if(!e||"string"!=typeof e.src)throw new E("on VPAIDHtml5Tech, invalid MediaFile");this.config=w.merge(w.deepCopy(this.default)||{},k);this.name="vpaid-html5";this.mediaFile=e;this.container=m;this._videoEl=k.videoEl.el||k.videoEl;this._player=k.player;this._id="vpaid_html5_"+w.nextID++;this._destroyed=!1},_adDestroyed:function(){this._removeAdElements();delete this._adUnit},_removeAdElements:function(){this._frame&&
(this.container.removeChild(this._frame),delete this._frame);if(this._destroyed)for(var m=this.container.childNodes,e=0;e<m.length;e++)"div"!==m[e].nodeName.toLowerCase()||""==m[e].id&&""==m[e].className||this.container.removeChild(m[e]);this._destroyLoadListener()},_unloadPreviousAdUnit:function(){this._removeAdElements();this._destroyAdUnit()},_destroyLoadListener:function(){this._onLoad&&(z.clearCallbackTimeout(this._onLoad),delete this._onLoad)},_destroyAdUnit:function(){this._adUnit&&(this._adUnit.destroy(),
delete this._adUnit)},destroy:function(){this._destroyed||(this._destroyed=!0,this.config.videoEl&&this.config.videoEl.destroy&&(this.config.videoEl.destroy(),this.config.videoEl=null),this._unloadPreviousAdUnit())},loadAdUnit:function(m){BPLR.log("FIRE VPAIDHtml5Tech loadAdUnit",(new Date).getTime());if(this._destroyed)BPLR.error("VPAIDHTML5Tech already destroyed!");else{this._unloadPreviousAdUnit();this._onLoad=w.$f(this,z.callbackTimeout(this.config.timeout,w.$f(this,function(b){var c;if(k.contentWindow){var p=
k.contentWindow.getVPAIDAd;"function"!=typeof p&&(c="the ad didn't return a function to create an ad")}else c="the iframe is not anymore in the DOM tree";if(!c){b=k.contentWindow.document.getElementById("bplr-vpaid-wrapper");w.css(b,{height:"100%"});var q=new T(p(),b,n,k,this._player);q.add("AdStopped",w.$f(this,this._adDestroyed));q.isValid||(c="the add is not fully complaint with VPAID specification")}this._adUnit=q;this._destroyLoadListener();m(c,c?null:q);return!0}),w.$f(this,function(){m(new E("Ad mediafile load timeout",
402),null)})));var e=this.mediaFile.src,k=w.createElement("iframe",{className:"bplr-tech",src:"javascript: false",allow:"autoplay",style:"border: 0px; width: 100%; height: 100%; position: absolute; overflow: hidden;"}),n=this._videoEl;this.container.appendChild(k);if(!k||!k.contentWindow)return this._player.destroy(),!1;k.contentWindow.bridVpaidCallback=this._onLoad;n=this._videoEl;k.soundAllowed=!1;z.checkIframeSound(k,"VPAIDHtml5Tech loadAdUnit");k.contentWindow.document.open().write("<body onload=\"var js = document.createElement('script'); js.src = '"+
e+'\'; js.addEventListener(\'load\', function() { window.bridVpaidCallback(); }); document.body.appendChild(js);" style="margin: 0;"><div id="bplr-vpaid-wrapper"></div></body>');"undefined"==typeof k.contentWindow.bridVpaidCallback&&(k.contentWindow.bridVpaidCallback=this._onLoad);k.contentWindow.document.close();BPLR.log("FIRE write iframe content",(new Date).getTime(),this._iframe);k.setAttribute("SCROLLING","NO");this._frame=k}}});X.supports=function(m){return-1<ba.html5.indexOf(m)};F.VPAID_techs.push(X);
var ca=BPLR.Sprite.extend({default:{responseTimeout:15E3,VPAID_VERSION:"2.0",preferredTech:"html5"},_isAdLoaded:!1,_adUnitEvents:"AdSkipped AdImpression AdDurationChange AdDurationChange AdStarted AdVideoStart AdPlaying AdPaused AdVideoFirstQuartile AdVideoMidpoint AdVideoThirdQuartile AdVideoComplete AdRemainingTimeChange AdClickThru AdUserAcceptInvitation AdUserClose AdUserMinimize AdError AdVolumeChange".split(" "),init:function p(e,k,n,b,c){p.base.call(this,e,b);this.playbackTech=n;this.viewMode=
"normal";this.adsManager=k;this.container=c;this.impressionFired=this._destroyed=!1},playAd:function(e){function k(r,t,C){r||c.impressionFired||(r=new E("Ad is corrupted, impression not fired",402));C.linearAdded&&!r&&c.adsManager.trigger("vast.contentResumeRequested");c.trackTimeInterval&&clearInterval(c.trackTimeInterval);c.mediaTimeout&&clearTimeout(c.mediaTimeout);r&&C&&c._trackError(r,C);n()}function n(){p!=c.player.tech&&(p.currentSrc()&&(p.src(""),p.removeSrc()),p.hide());setTimeout(function(){b.trigger("vast.adEnd")},
0)}var b=this.adsManager,c=this,p=this.playbackTech;BPLR.log("VPAIDManager.playAd looking for supported tech...");var q=this.tech=this._findSupportedTech(e,this.config);this._fakeAdUnit=null;this._adFinishCalled=this._adErrored=this._adStarted=!1;b.add("vast.adsCancel",n);b.addOnce(["vast.adEnd","vast.adError"],this.$f(function(){c.trackTimeInterval&&clearInterval(c.trackTimeInterval);c.mediaTimeout&&clearTimeout(c.mediaTimeout);this._adStarted=!1;b.remove("vast.adsCancel",n);try{this.destroy()}catch(r){BPLR.error("BPLR AdSDK error removing VPAID",
r)}}));if(q)BPLR.log("VPAIDManager.playAd found tech: ",q,(new Date).getTime()),this._response=e,R.waterfall([function(r){r(null,q,e)},this.$f(this._loadAdUnit),this.$f(this._playAdUnit),this.$f(this._waitForAdEnd)],this.$f(function(r,t,C){k(r,t,C)}));else{BPLR.error("VPAIDManager.playAd could not find suitable tech");var l=new E("on VPAIDManager.playAd, could not find a supported mediaFile",403);k(l,this._fakeAdUnit,e);return null}this._remainingTime=this._duration=this._currentVolume=0;this._validRemainingTime=
!0;return this._fakeAdUnit={_paused:!0,type:"VPAID",pauseAd:function(){c._pauseAdUnit()},resumeAd:function(){c._resumeAdUnit()},isPaused:function(){return c._paused},getSrc:function(){return q.mediaFile},getWidth:function(){return c._width},getHeight:function(){return c._height}}},_findSupportedTech:function(e,k){var n=this.player;if(!e)return null;e=0<e.mediaFiles.length?e.mediaFiles.filter(F.isVPAID):[e.nonLinear];var b=k&&k.preferredTech,c=[],p,q,l;(k=this.videoEl=this.playbackTech.el)&&"fakeVideoElement"===
k.id?this.addChild(k):this.playbackTech.show();var r=0;for(p=e.length;r<p;r+=1){var t=e[r];if(q=F.findSupportedVPAIDTech(t.type)){if(l=b?t.type===b||ba[b]&&-1<ba[b].indexOf(t.type):!1)return BPLR.log("BPLR AdSDK call VPAIDTech",q),new q(this.container,t,{videoEl:k,player:n});c.push({mediaFile:t,tech:q})}}return c.length?(n=c[0],new n.tech(this.container,n.mediaFile,{videoEl:k})):null},_createVPAIDAdUnitWrapper:function(e,k,n){return new Z(e,{src:k,responseTimeout:n})},_loadAdUnit:function(e,k,n){var b=
this,c=this.config.responseTimeout;BPLR.log("VPAIDManager _loadAdUnit",(new Date).getTime());e.loadAdUnit(function(p,q){if(p)return n(p,q,k);try{var l=b._createVPAIDAdUnitWrapper(q,e.mediaFile.src,c);n(null,l,k)}catch(r){n(r,q,k)}})},_playAdUnit:function(e,k,n){this._adUnit=e;k.linearAdded?this.adsManager.trigger("vast.contentPauseRequested"):this.adsManager.trigger("vast.contentResumeRequested");R.waterfall([function(b){b(null,e,k)},this.$f(this._handshake),this.$f(this._initAd),this.$f(this._setupEvents),
this.$f(this._startAd)],n)},_handshake:function(e,k,n){e.handshakeVersion(this.config.VPAID_VERSION,function(b,c){if(b)return n(b,e,k);if(b=c)b=c.split("."),b=parseInt(b[0],10),b=1<=b&&2>=b;return b?n(null,e,k):n(new E('on VPAIDManager._handshake, unsupported version "'+c+'"'),e,k)})},_initAd:function(e,k,n){function b(p){this._adErrored=!0;e.remove("AdError",b);n(new E("on VPAIDManager, Ad unit dispatched an error event ",901,p),e,k)}var c=this.player;e.add("AdLoaded",this.$f(function(){this._isAdLoaded=
!0}));e.add("AdError",this.$f(b));this.adsManager.addOnce("vast.adEnd",this.$f(function(){e.remove("AdError",b)}));e.initAd(c.el.offsetWidth,c.el.offsetHeight,ca.VIEW_MODE.NORMAL,-1,{AdParameters:k.adParameters||""},"",function(p){n(p,e,k)})},_createVASTTracker:function(e,k){return new W(e,k)},_setupEvents:function(e,k,n){this.tracker=this._createVASTTracker(e.config.src,k);this._adUnitEvents.forEach(this.$f(function(b){this._adUnit.add(b,this.$f(this._onAdUnitEvent))}));n(null,e,k)},_pauseAdUnit:function(){this._adUnit.pauseAd()},
_resumeAdUnit:function(){this._adUnit.resumeAd()},_removeEvents:function(){this._adUnit&&this._adUnitEvents.forEach(this.$f(function(e){this._adUnit.remove(e,this.$f(this._onAdUnitEvent))}))},_onAdUnitEvent:function(e){function k(l){var r={ASSETURI:p.config.src,CONTENTPLAYHEAD:0};return l?F.parseURLMacro(l,r):null}if(!this._destroyed){var n=this.tracker,b=this.player,c=this.adsManager,p=this._adUnit;switch(e.type){case "AdSkipped":c.trigger("vast.adSkip");n.trackSkip();break;case "AdImpression":BPLR.log("AdSDK VPAIDManager on AdImpression");
c.trigger("vast.adImpression");break;case "AdDurationChange":w.throttle(this.$f(function(){p.getAdDuration(this.$f(function(l,r){this._duration=parseInt(l||0>=r?this._response.duration:r);c.trigger("vast.adDurationChange")}))}),2E3,this);break;case "AdStarted":BPLR.log("AdSDK VPAIDManager AdStarted");BPLR.log("Fire impression on AdStarted");this.impressionFired=!0;n.trackImpressions();p.getAdDuration(this.$f(function(l,r){this._remainingTime=this._duration=parseInt(l||0>=r?this._response.duration:
r);c.trigger("vast.adDurationChange")}));this.mediaTimeout&&clearTimeout(this.mediaTimeout);this.trackTimeInterval&&clearInterval(this.trackTimeInterval);this.trackTimeInterval=setInterval(this.$f(function(){p.getAdRemainingTime(this.$f(function(l,r){l||isNaN(r)?this._validRemainingTime=!1:(this._validRemainingTime=!0,this._remainingTime=parseInt(r||this._duration))}))}),500);p.getAdWidth(this.$f(function(l,r){l||(this._width=r)}));p.getAdHeight(this.$f(function(l,r){l||(this._height=r)}));c.trigger("vast.adStart");
this._paused=!1;this._adStarted=!0;n.trackCreativeView();break;case "AdVideoStart":BPLR.log("AdSDK VPAIDManager AdVideoStart isLinear",p._adUnit._creative.getAdLinear());c.trigger("vast.adVideoStart");this._paused=!1;n.trackStart();p.getAdDuration(this.$f(function(l,r){BPLR.log("VPAIDManager ad duration",r);-1==r&&(this.vpaidOverlayTimeout=setTimeout(this.$f(this._onVpaidOverlayTimeout),15E3))}));break;case "AdPlaying":BPLR.log("AdSDK VPAIDManager AdPlaying");c.trigger("vast.adResume");this._paused=
!1;b.trigger("play");n.trackResume();break;case "AdPaused":w.isMobilePlatform()&&z.checkIframeSound(p._adUnit._iframe,"AdPaused");c.trigger("vast.adPause");this._paused=!0;n.trackPause();break;case "AdVideoFirstQuartile":c.trigger("vast.firstQuartile");n.directTrackQuartile("firstQuartile",1E3*this.getAdCurrentTime());clearTimeout(this.vpaidOverlayTimeout);break;case "AdVideoMidpoint":c.trigger("vast.midpoint");n.directTrackQuartile("midpoint",1E3*this.getAdCurrentTime());break;case "AdVideoThirdQuartile":c.trigger("vast.thirdQuartile");
n.directTrackQuartile("thirdQuartile",1E3*this.getAdCurrentTime());break;case "AdVideoComplete":c.trigger("vast.adVideoComplete");n.trackComplete();this.vpaidNonLinearTimeout=setTimeout(this.$f(this._onVpaidNonLinearTimeout),5E3);break;case "AdRemainingTimeChange":this.trackTimeInterval&&clearInterval(this.trackTimeInterval);p.getAdRemainingTime(this.$f(function(l,r){l||isNaN(r)?this._validRemainingTime=!1:(this._validRemainingTime=!0,this._remainingTime=parseInt(r||this._duration))}));n.trackProgress(1E3*
this.getAdCurrentTime(),!0);break;case "AdClickThru":var q=e.data;!w.isMobilePlatform()&&z.checkIframeSound(p._adUnit._iframe,"AdClickThru");c.trigger("vast.adClickThru");e=q.url;q=q.playerHandles;e=e?e:k(this._response.clickThrough);n.trackClick();q&&e&&N.open(e,"_blank");break;case "AdUserAcceptInvitation":c.trigger("vast.adUserAcceptInvitation");break;case "AdUserMinimize":c.trigger("vast.adUserMinimize");break;case "AdVolumeChange":this._adStarted&&p.getAdVolume(this.$f(function(l,r){this._currentVolume!==
r&&(0===r&&0<this._currentVolume&&n.trackMute(),0<r&&0===this._currentVolume&&n.trackUnmute(),this._currentVolume=r,c.trigger("vast.adVolumeChange"),b.trigger("vast.adVolumeChange"))}))}}},_onVpaidNonLinearTimeout:function(){BPLR.log("Stop non Linear VPAID- Banner");this._adUnit._adUnit._creative.stopAd()},_onVpaidOverlayTimeout:function(){BPLR.log("Stop non Linear VPAID - Overlay");this._adUnit._adUnit._creative.stopAd()},_addSkipButton:function(e,k,n){function b(r){q=new fa(r,{skipOffset:0});q.add("skip",
p.$f(function(){e.skipAd();tracker.trackSkip();p.adsManager.trigger("vast.adSkip")}));p.addChild(q)}function c(){p.removeChild(q);q=null}var p=this,q,l=this.player;e.add("AdSkippableStateChange",function(){p.adsManager.trigger("vast.adSkippableStateChange");e.getAdSkippableState(function(r,t){t?q||b(l):c(l)})});this.addOnce(["vast.adEnd","vast.adsCancel"],c);n(null,e,k)},_startAd:function(e,k,n){this.mediaTimeout&&clearTimeout(this.mediaTimeout);this.mediaTimeout=setTimeout(this.$f(this._onMediaTimeout),
this.config.responseTimeout);if(this._isAdLoaded)this._adLoaded(e,k,n);else{try{w.isMobilePlatform()&&(this._hackVideoMuted(e),this._hackPlayButton(e))}catch(b){BPLR.error("AdSDK VPAIDManager hack play button error",b)}e.add("AdLoaded",this.$f(function(){this._adLoaded(e,k,n)}))}},_onMediaTimeout:function(){this._trackError(new E("Ad mediafile load timeout",402),this._response);w.isMobilePlatform()&&w.isIOS()||this.playbackTech.hide()},_adLoaded:function(e,k,n){var b=this.player;BPLR.log("\tsetAdVolume _adLoaded");
this.setAdVolume(b.values.muted?0:b.values.volume||0);w.isMobilePlatform()&&(this._hackVideoMuted(e),this._hackPlayButton(e));e.startAd(this.$f(function(c){n(null,e,k)}),b.config.autoplay)},_hackPlayButton:function(e){if(e=e._adUnit._iframe){var k=e.contentDocument?e.contentDocument:e.contentWindow.document,n=new CustomEvent("click",{bubbles:!0,cancelable:!0});k.body&&-1!=k.body.style.background.indexOf('url("data:image')&&k.body.dispatchEvent(n);Array.prototype.map.call(k.getElementsByTagName("svg"),
function(b){b.dispatchEvent(n)});Array.prototype.map.call(k.getElementsByClassName("play_overlay"),function(b){Array.prototype.map.call(k.getElementsByTagName("video"),function(c){!(c.src||c.children&&0!==c.children.length)&&3>c.readyState||b.dispatchEvent(n)})});Array.prototype.map.call(k.getElementsByTagName("video"),function(b){!(b.src||b.children&&0!==b.children.length)&&3>b.readyState||b.play()})}},_hackVideoMuted:function(e){function k(c){var p=c.play;if(c===b.videoEl||c.src||c.children&&0!==
c.children.length)-1===c.className.indexOf(BPLR.mainClassName)&&w.css(c,{"-webkit-transform":"translateX(1024px)"}),c.play=function(){function q(l){c.removeEventListener("play",q);w.css(c,{"-webkit-transform":"translateX(0)"})}c.muted=n.values.muted;c.play=p;BPLR.log("AdSDK hackVideoMuted _this.videoEl",b.videoEl,n.values.muted);BPLR.log("AdSDK hackVideoMuted videoNode",c);BPLR.log("AdSDK hackVideoMuted videoNode",c.src);c.addEventListener("error",function(l){});-1===c.className.indexOf(BPLR.mainClassName)&&
c.addEventListener("play",q);setTimeout(function(){c.play()},200)}}var n=this.player,b=this;e=e._adUnit._iframe;Array.prototype.map.call((e.contentDocument?e.contentDocument:e.contentWindow.document).getElementsByTagName("video"),k);Array.prototype.map.call(b.container.getElementsByTagName("video"),k)},_waitForAdEnd:function(e,k,n){function b(p){c._adFinishCalled||(BPLR.log("VPAIDManager clear timeouts"),clearTimeout(c.vpaidNonLinearTimeout),clearTimeout(c.vpaidOverlayTimeout),this._adFinishCalled=
!0,n(p,e,k))}var c=this;e.add("AdStopped",this.$f(function(){this._adErrored||(this.adsManager.trigger("vast.adStopped"),b(null))}));e.add("AdSkipped",this.$f(function(){this._adErrored||(this.adsManager.trigger("vast.adStopped"),b(null))}));e.add("AdUserClose",this.$f(function(){this._adErrored||(this.adsManager.trigger("vast.adUserClose"),b(null))}))},_trackError:function(e,k){this.trackTimeInterval&&clearInterval(this.trackTimeInterval);F.track(k.errorURLMacros,{ERRORCODE:e.code||901});this.adsManager.adError(e,
k)},stop:function(){this._adUnit.trigger("AdUserClose")},setAdVolume:function(e){var k=this.player;BPLR.log("AdSDK VPAIDManager setAdVolume",e);BPLR.log("AdSDK VPAIDManager setAdVolume",0===e);if(this._adUnit){BPLR.log("this._adUnit._adUnit.isVpaidVideoElementUsed",this._adUnit._adUnit.isVpaidVideoElementUsed);this._adUnit.setAdVolume(e);var n=this._adUnit._adUnit._iframe,b=this._adUnit._adUnit;if(n){var c=n.contentDocument?n.contentDocument:n.contentWindow?n.contentWindow.document:null;c&&Array.prototype.map.call(c.getElementsByTagName("video"),
function(p){b.isVpaidVideoElementUsed=!0;BPLR.log("AdSDK VPAIDManager setAdVolume innerDoc iframeNode.soundAllowed",n.soundAllowed);w.isMobilePlatform()&&!w.isAndroid()||n.soundAllowed?p.muted=0===e:(p.muted=!0,w.isAndroid()&&(BPLR.log("ANDORID MUTE PLAYER",k,k.tag),k.tag.muted=!0))})}BPLR.log("VPAIDManager this.videoEl",this.videoEl);this.videoEl&&this.videoEl.el?(BPLR.log("VPAIDManager this.videoEl 1"),this.videoEl.setVolume(e)):this.videoEl&&(BPLR.log("VPAIDManager this.videoEl 2"),this.videoEl.muted=
0===e);b.isVpaidVideoElementUsed&&(this.videoEl.muted=!0)}},getAdVolume:function(){return this._currentVolume||0},resize:function(e,k,n,b,c){var p=this;this._response.nonLinear?w.css(this.container,{top:e+"px",left:k+"px"}):w.css(this.container,{top:0,left:0,height:b+"px"});this.tech._adUnit&&!this.tech._adUnit._creative.getAdLinear()&&w.css(this.container,{top:e+"px",left:k+"px",height:b+"px"});p._adUnit.resizeAd(n,b,c,function(q){q||(p._adUnit.getAdWidth(function(l,r){l||(p._width=r)}),p._adUnit.getAdHeight(function(l,
r){l||(p._height=r)}))});p.tracker&&p.viewMode!==c&&(p.viewMode=c,"fullscreen"===c?p.tracker.trackFullscreen():p.tracker.trackExitFullscreen())},getAdDuration:function(){return this._duration},getAdCurrentTime:function(){return this._validRemainingTime&&-.5<this._remainingTime&&this._remainingTime!=this._duration?this._duration-this._remainingTime:this.videoEl&&this.videoEl.currentTime},addChild:function n(k){n.base.call(this,k);this.container.appendChild(k.el)},removeChild:function b(n){this.container.removeChild(n.el);
b.base.call(this,n)},destroy:function b(){this._isAdLoaded=!1;this._destroyed=!0;this.trackTimeInterval&&clearInterval(this.trackTimeInterval);this.mediaTimeout&&clearTimeout(this.mediaTimeout);this._removeEvents();this.tech&&(this.tech.destroy(),this.tech=null);b.base.call(this)}});ca.VIEW_MODE={NORMAL:"normal",FULLSCREEN:"fullscreen",THUMBNAIL:"thumbnail"};var Da=BPLR.Class.extend({default:{WRAPPER_LIMIT:8},init:function(b,c){var p=w.deepCopy(this.default);this.config=w.merge(p||{},b);this.player=
c;delete this.default;this.waterfallAds=[];this.errorURLMacros=[];this._adChainFork=[]},getVASTResponse:function(b,c){function p(l,r){try{var t=q._buildVASTResponse(l);r(null,t)}catch(C){r(C)}}var q=this;"string"===typeof b||z.isFunction(b)?(q._adChainFork=[],q.waterfallAds=[],R.waterfall([this._getVASTAd.bind(this,b),p],c)):(0<q._adChainFork.length?(q._adChainFork[0].forkLength&&(q._adChainFork[0].forkLength--,0>=q._adChainFork[0].forkLength&&q._adChainFork.shift()),q._adChain=[].concat(q._adChainFork[0]||
[])):q._adChain=[],R.waterfall([this._getAd.bind(this,b,q._adChain),p],c))},_getVASTAd:function(b,c){function p(l,r){var t=[];try{l.forEach(function(C){t.push(new ja(C))}),r(null,t)}catch(C){r(new E("on AdsLoader._buildAd, error parsing VMAP",1002),null)}}var q=this;R.waterfall([this._requestVASTXml.bind(this,b),function(l,r){try{var t=q.vastTree=B.toJXONTree(l);q.player.values.lastVASTXML=(new XMLSerializer).serializeToString(l);if("undefined"!==typeof t.ad)t.ads=z.isArray(t.ad)?t.ad:[t.ad];else if("undefined"!==
typeof t.adBreak)t.adBreaks=z.isArray(t.adBreak)?t.adBreak:[t.adBreak],delete t.adBreak;else if("undefined"!==typeof t.preroll||"undefined"!==typeof t.postroll)t.adBreaks=[],"undefined"!==typeof t.preroll&&(t.preroll["@breakId"]="preroll",t.preroll["@breakType"]="linear",t.preroll["@timeOffset"]="start",t.adBreaks.push(t.preroll),delete t.preroll),"undefined"!==typeof t.postroll&&(t.postroll["@breakId"]="postroll",t.postroll["@breakType"]="linear",t.postroll["@timeOffset"]="end",t.adBreaks.push(t.postroll),
delete t.postroll)}catch(C){r(new E("on AdsLoader._getVASTAd.buildVastWaterfall, error parsing xml",100),null);return}r(q.validateVASTTree(t),t)}],function(l,r){function t(L,M){L?(q._trackError(L,M),0<q.waterfallAds.length?(0<q._adChainFork.length?(q._adChainFork[0].forkLength&&(q._adChainFork[0].forkLength--,0>=q._adChainFork[0].forkLength&&q._adChainFork.shift()),M=[].concat(q._adChainFork[0]||[])):M=[],q._getAd(q.waterfallAds.shift(),M,t)):c(L,M)):c(null,M)}var C=r&&z.isArray(r.ads)?r.ads:null;
r=r&&z.isArray(r.adBreaks)?r.adBreaks:null;if(l)return q._trackError(l,C),c(l,C);C&&0<C.length?(C=q.waterfallAds=q.waterfallAds.concat(C),q._getAd(C.shift(),[],t)):r&&0<r.length?p(r,c):c(new E("on AdsLoader._getVASTAd.validateVASTTree, no Ads in VAST response",303))})},validateVASTTree:function(b){var c=B.attr(b,"version");B.attr(b,"xmlns:vmap");return b.ad||b.adBreaks?c&&3!=c&&2!=c&&b.adBreaks&&1!=c?new E('on AdsLoader._getVASTAd.validateVASTTree, not supported VAST version "'+c+'"',102):c&&b.adBreaks&&
1!=c?new E('on AdsLoader._getVASTAd.validateVASTTree, not supported VMAP version "'+c+'"',1001):null:new E("on AdsLoader._getVASTAd.validateVASTTree, no Ads in VAST response",303)},_getAd:function(b,c,p){function q(r,t){l._requestVASTXml(r,function(C,L){if(C)return t(C);try{l.player.values.lastVASTXML=(new XMLSerializer).serializeToString(L);var M=B.toJXONTree(L);t(l.validateVASTTree(M),M.ad)}catch(ka){t(new E("on AdsLoader._getVASTAd.requestVASTAd, error parsing xml",100))}})}var l=this;this._adChain=
c||[];if(c.length>=l.config.WRAPPER_LIMIT)return p(new E("on AdsLoader._getVASTAd._getAd, players wrapper limit reached (the limit is "+l.config.WRAPPER_LIMIT+")",302),c);R.waterfall([function(r){"string"===typeof b?q(b,r):r(null,b)},function(r,t){z.isArray(r)?t(null,r):l._buildAd(r,t)}],function(r,t){if(z.isArray(t)&&(l.waterfallAds=t.concat(l.waterfallAds),0<l.waterfallAds.length))return r=[].concat(c),r.forkLength=t.length,l._adChainFork.unshift(r),l._getAd(l.waterfallAds.shift(),c,p);t&&c.push(t);
return r?p(r,c):t.wrapper?(t="undefined"!==typeof $BPLRIq&&$BPLRIq.isAdBlockEnabled()?"http://lkdasjdsaa98d7sadaslkjds.xyz/?"+btoa(t.wrapper.VASTAdTagURI):t.wrapper.VASTAdTagURI,l._getAd(t,c,p)):p(null,c)})},_buildAd:function(b,c){function p(l){var r=l.wrapper;if((l=l.inLine)&&r)return new E("on AdsLoader._getVASTAd.validateAd, InLine and Wrapper both found on the same Ad",101);if(!l&&!r)return new E("on AdsLoader._getVASTAd.validateAd, nor wrapper nor inline elements found on the Ad",101);if(l&&
0===l.creatives.length)return new E("on AdsLoader._getVASTAd.validateAd, missing creative in InLine element",101);if(r&&!r.VASTAdTagURI)return new E("on AdsLoader._getVASTAd.validateAd, missing 'VASTAdTagURI' in wrapper",101)}try{var q=new ia(b);c(p(q),q)}catch(l){c(new E("on AdsLoader._getVASTAd._buildAd, error parsing xml",100),null)}},_requestVASTXml:function(b,c){function p(K){BPLR.log("FIRE XML TAG LOADED",(new Date).getTime());c(null,K)}function q(K){if(0===parseInt(K)&&r)r=!1,BPLR.Loader.loadText(z.urlParts(b).href,
p,q,null,r);else return c(new E("undefined"!==typeof K?"on AdsLoader.requestVastXML, HTTP request error with status '"+K+"'":"on AdsLoader.requestVastXML, Error getting the the VAST XML with he passed adTagXML fn",301),null)}function l(K,U,da){return-1!=K.toLowerCase().indexOf(".spotxchange.")?K.replace(new RegExp("="+U.replace(/(\[|])/g,"\\$1"),"gi"),"="+da):K.split(U).join(da).split(U.toUpperCase()).join(da)}var r=!0,t=this.player;try{if(z.isFunction(b))b(requestHandler);else if(w.validateURL(b)){0<
b.indexOf("//googleads")&&10>b.indexOf("//googleads")&&(b="https://ima3vpaid.appspot.com/?adTagUrl="+b+"&type=js");if(-1!=b.toLowerCase().indexOf("[gdpr]")){var C=O.BPLRIframeBurst?N.top:N;"function"===typeof C.__tcfapi?C.__tcfapi("getTCData",2,function(K,U){b=l(b,"[gdpr]",K.gdprApplies?"1":"0");K.gdprApplies&&-1!=b.toLowerCase().indexOf("[consent]")&&(b=l(b,"[consent]",K.tcString))}):"function"===typeof C.__cmp?C.__cmp("getConsentData",null,function(K){b=l(b,"[gdpr]",K.gdprApplies?"1":"0");K.gdprApplies&&
-1!=b.toLowerCase().indexOf("[consent]")&&(b=l(b,"[consent]",K.consentData))}):b=l(b,"[gdpr]","0")}-1!=b.toLowerCase().indexOf("[us_privacy]")&&(C=O.BPLRIframeBurst?N.top:N,"function"===typeof C.__uspapi?C.__uspapi("getUSPData",1,function(K,U){b=l(b,"[us_privacy]",U?K.uspString:"")}):b=l(b,"[us_privacy]",""));if(-1!==b.toLowerCase().indexOf("[timestamp]")){var L=(new Date).getTime();b=l(b,"[timestamp]",L)}-1!==b.toLowerCase().indexOf("[referrer_url]")&&(b=l(b,"[referrer_url]",encodeURIComponent(-1!==
b.indexOf("doubleclick")?w.getEmbededUrl():la.referrer)));-1!==b.toLowerCase().indexOf("[description_url]")&&(b=l(b,"[description_url]",encodeURIComponent(w.getEmbededUrl())));-1!==b.toLowerCase().indexOf("[page_url]")&&(b=l(b,"[page_url]",encodeURIComponent(w.getEmbededUrl())));-1!==b.toLowerCase().indexOf("[video_title]")&&(b=l(b,"[video_title]",encodeURIComponent(t.currentSource.title)));-1!==b.toLowerCase().indexOf("[video_duration]")&&(b=l(b,"[video_duration]",t.duration()||t.currentSource.duration));
-1!==b.toLowerCase().indexOf("[video_id]")&&(b=l(b,"[video_id]",t.currentSource.id));-1!==b.toLowerCase().indexOf("[player_width]")&&t.el&&t.el.clientWidth&&(b=l(b,"[player_width]",t.el.clientWidth));-1!==b.toLowerCase().indexOf("[player_height]")&&t.el&&t.el.clientHeight&&(b=l(b,"[player_height]",t.el.clientHeight));-1!==b.toLowerCase().indexOf("[autoplay]")&&(b=l(b,"[autoplay]",t.config.autoplay?"1":"0"));-1!==b.toLowerCase().indexOf("[description]")&&(b=l(b,"[description]",encodeURIComponent(t.currentSource.description)));
-1!==b.toLowerCase().indexOf("[mediafile_url]")&&(b=l(b,"[mediafile_url]",encodeURIComponent(t.currentSource.src)));-1!==b.toLowerCase().indexOf("[dnt]")&&(b=l(b,"[dnt]",navigator.doNotTrack&&"1"===navigator.doNotTrack?"1":"0"));-1!=b.toLowerCase().indexOf("[uid]")&&(b=l(b,"[uid]",w.getSession()));-1!=b.toLowerCase().indexOf("[video_tags]")&&(b=l(b,"[video_tags]",encodeURIComponent(t.currentSource.tags||"")));if(-1!=b.toLowerCase().indexOf("[bplr_")){var M;t=b;for(C=/\[bplr_([a-zA-Z0-9_]+)\]/g;M=
C.exec(b);)t=l(t,M[0],encodeURIComponent("undefined"!=typeof bplrMacros&&M[1]in bplrMacros?bplrMacros[M[1]]:""));b=t}if(-1!==b.toLowerCase().indexOf("[user_agent]")){var ka=encodeURIComponent(w.ua);b=l(b,"[user_agent]",ka)}r=!0;BPLR.log("FIRE TAG",b,(new Date).getTime());BPLR.Loader.loadText(z.urlParts(b).href,p,q,null,r)}else c(null,b)}catch(K){c(K)}},_buildVASTResponse:function(b){b=b.length?b:[b];if("undefined"!==typeof b[0].breakId){var c=new Aa;b.forEach(function(p){c.addAdBreak(p)})}else{c=
new za;b.forEach(function(p){c.addAd(p)});if(c.hasLinear()&&"undefined"===typeof c.duration)throw new E("on AdsLoader._buildVASTResponse, Missing duration field in VAST response",101);(b=c.trackingEvents.progress)&&b.forEach(function(p){if(isNaN(p.offset))throw new E("on AdsLoader._buildVASTResponse, missing or wrong offset attribute on progress tracking event",101);})}return c},_trackError:function(b,c){if(z.isArray(c)&&0!==c.length){var p=[];c.forEach(function(q){q.wrapper&&q.wrapper.error&&p.push(q.wrapper.error);
q.inLine&&q.inLine.error&&p.push(q.inLine.error)});F.track(p,{ERRORCODE:b.code||900})}}});BPLR.AdSDK.AdsManager=BPLR.Sprite.extend({default:{adCancelTimeout:15E3,adsEnabled:!0},adManager:null,defaultCss:".bplr-iab-blocker,.bplr-static-container{position:absolute}a.bplr-static-container{bottom:50px;left:50%;transform:translateX(-50%);width:fit-content;}.bplr-iab-skip-button{display:none;position:absolute;bottom:3em;right:1em;color:#fff;font-size:14px!important;text-align:center;height:3em;padding-left:1em;padding-right:1em;line-height:3em!important;background:#000;background:rgba(0,0,0,.8)}.bplr-iab-blocker{top:0;left:0;width:100%;height:100%}.bplr-static-container img{display:block;width:100%!important;height:auto!important}",
init:function l(c,p,q){l.base.call(this,c,p);w.createCSS(this.defaultCss,"bridVAST",c);c.add("error",this.$f(function(){this.adsCanceled=!0}));this.videoSlot=new S({id:c.id+"_video_slot",autoplay:c.config.autoplay,muted:c.values.muted});q.appendChild(this.videoSlot.el);this.videoSlot.el.addEventListener("volumechange",function(r){BPLR.log("The volume changed - PLAYER.",c.tag.volume,c.tag.muted);BPLR.log("The volume changed - SLOT.",this.videoSlot.el.volume,this.videoSlot.muted());1==this.videoSlot.el.volume&&
!this.videoSlot.muted()&&c.tag.muted&&(BPLR.log("Prevent Vpaid volume"),this.videoSlot.el.muted=!0)}.bind(this));this.container=q;this.player.add("newContent",this.$f(this.onNewContent));this.onNewContent();this.adsLoader=new Da({},c)},onNewContent:function(){O.fullscreenEnabled||O.BPLRIframeBurst&&w.isFF()&&!w.isMobilePlatform()?this.playbackTech=this.videoSlot:this.player.hasHLS&&w.isFacebookApp()&&w.isAndroid()?this.playbackTech=this.videoSlot:this.playbackTech=this.player.tech},requestAd:function(c,
p){this.waitForPlaylistEnd=this.hasAdBreaks=this.adsCanceled=!1;-1!=c.indexOf("correlator=")&&(z.queryStringToObj(c).correlator||(c=c.replace(/correlator=/g,"correlator="+(new Date).getTime())));this.adCancelTimeoutId=setTimeout(this.$f(function(){this.adError(new E("timeout while waiting for the ad to start playing",402))}),this.config.adCancelTimeout);this.adsLoader.getVASTResponse(c,this.$f(function(q,l){this.adsCanceled||(this._clearAdCancelTimeout(),q?this.adError(q,l):(this._response=l,void 0!==
l.adBreaks&&(this.hasAdBreaks=!0,this._playlistResponse=l),p()))}))},_clearAdCancelTimeout:function(){this.adCancelTimeoutId&&(clearTimeout(this.adCancelTimeoutId),this.adCancelTimeoutId=null)},initializePlaybackTech:function(){this.onNewContent();(this.playbackTech!==this.player.tech||this.player.showOnAd())&&this.playbackTech.load()},playAd:function(){var c=this._response||this._playlistResponse;this.adsCanceled||(c||this.adError(new E("On AdsManager, missing required VASTResponse")),this.hasAdBreaks?
this._scheduleAdBreaks():this._doPlayAd(c))},_scheduleAdBreaks:function(){function c(C){(q=this._playlistResponse.prerollAdBreaks())&&0<q.length?this._requestAdBreak(q.shift()):(this.waitForPlaylistEnd=!1,this.remove(["vast.adEnd","vast.adError"],this.$f(c)),this.trigger("vast.contentResumeRequested"))}function p(){(l=this._playlistResponse.postrollAdBreaks())&&0<l.length?this._requestAdBreak(l.shift()):(this.waitForPlaylistEnd=!1,this.remove(["vast.adEnd","vast.adError"],this.$f(p)),this.trigger("vast.contentResumeRequested"))}
var q=[],l=[],r=[],t=this.player;(q=this._playlistResponse.prerollAdBreaks())?q.map(this.$f(function(C,L){0==L&&(t.currentTime()?this._requestAdBreak(C):!t.waitingForAd||t.isPlaying||t.ended()?t.addOnce("beforeStart",this.$f(function(){this.waitForPlaylistEnd=!0;this.add(["vast.adEnd","vast.adError"],this.$f(c));this._requestAdBreak(C)})):(this.waitForPlaylistEnd=!0,this.add(["vast.adEnd","vast.adError"],this.$f(c)),this._requestAdBreak(C)))})):this.trigger("vast.contentResumeRequested");(l=this._playlistResponse.postrollAdBreaks())&&
l.map(this.$f(function(C,L){if(0==L)if(this.player.hasPostroll=!0,t.waitingForAd&&t.ended())this.waitForPlaylistEnd=!0,this.add(["vast.adEnd","vast.adError"],this.$f(p)),this._requestAdBreak(C);else{var M=this.$f(function(){t.getAdInProgress()||(t.remove("ended",M),this.waitForPlaylistEnd=!0,this.add(["vast.adEnd","vast.adError"],this.$f(p)),this._requestAdBreak(C))});t.add("ended",M)}}));if(r=this._playlistResponse.midrollAdBreaks())this._midrollsCheck=this.$f(function(){this.midrollPlaying||t.getAdInProgress()||
this._checkForMidrolls(r)}),t.add("timeupdate",this._midrollsCheck)},_checkForMidrolls:function(c){function p(r,t){return("string"===typeof r.timeOffset?-1==r.timeOffset.indexOf("%")?r.timeOffset:r.timeOffset*q.duration()/100:r.timeOffset)<=t}for(var q=this.player,l=0;l<c.length;){if(p(c[l],q.currentTime())){this.midrollPlaying=!0;this.addOnce(["vast.adEnd","vast.adError"],this.$f(function(){this.midrollPlaying=!1}));this._requestAdBreak(c.shift());break}l++}0==c.length&&q.remove("timeupdate",this._midrollsCheck)},
_requestAdBreak:function(c){function p(C){0<this.adsLoader.vastTree.ads.length?this.adsLoader.getVASTResponse(this.adsLoader.vastTree.ads.shift(),this.$f(q)):this.remove(["vast.adError","vast.adEnd"],this.$f(p))}function q(C,L){if(!this.adsCanceled)if(C)this.currentAdBreak=null,this.adError(C,L);else{this._response=L;this._doPlayAd(L);if(C=c.trackingEvents)C.breakStart&&this.adManager.addOnce("vast.adStart",this.$f(l)),C.breakEnd&&this.adManager.addOnce("vast.adEnd",this.$f(r)),C.error&&this.adManager.addOnce("vast.adError",
this.$f(t));this._clearAdCancelTimeout()}}function l(){this.adManager.tracker.trackEvent("breakStart",!0,c)}function r(){this.adManager.tracker.trackEvent("breakEnd",!0,c)}function t(){this.adManager.tracker.trackEvent("error",!0,c)}c.played||(c.played=!0,this.currentAdBreak=c,this.adsCanceled=!1,c.adSource.allowMultipleAds&&this.add(["vast.adError","vast.adEnd"],this.$f(p)),this.adsLoader.getVASTResponse(c.adSource.adTagURI,this.$f(q)))},_doPlayAd:function(c){if(this.adManager)try{this.adManager.destroy(),
this.adManager=null}catch(l){BPLR.error("BPLR AdSDK error removing VPAID",l)}this.addOnce("vast.adImpression",this.$f(this._onAdImpressionCheckViewability));var p=c.mediaFiles;c.interactiveCreativeFile&&0<c.interactiveCreativeFile.length&&(p=c.interactiveCreativeFile,c.mediaFilesOriginal=c.mediaFiles,c.mediaFiles=c.interactiveCreativeFile);var q=p.filter(F.isVPAID);0<q.length&&q.length>=p.length?(this.isVPAID=!0,p=new ca(this.player,this,this.playbackTech,{responseTimeout:this.config.adCancelTimeout},
this.container)):(this.isVPAID=!1,p=new Ba(this.player,this,this.playbackTech,{responseTimeout:this.config.adCancelTimeout},this.container));this.adManager=p;this.adUnit=this.adManager.playAd(c)},_onAdImpressionCheckViewability:function(){function c(){l.player.isPlayerInView()&&!t&&(r=(new Date).getTime(),t=setInterval(p,50))}function p(){if(l.adManager&&l.adManager.tracker){var C=(new Date).getTime(),L=l.isLinear()?2E3:1E3;l.player.isPlayerInView()&&r+L<C?(q(),l.adManager.tracker.trackViewableImpressions(),
l.adManager.tracker.trackEvent("viewable_impression",!0),l.adManager.tracker.trackEvent("measurable_impression",!0)):!l.player.isPlayerInView()&&t&&(clearInterval(t),t=null)}}function q(){Q.remove(N,"scroll",c);t&&(clearInterval(t),t=null)}var l=this;if(l.player.isPlayerInView()){var r=(new Date).getTime();var t=setInterval(p,50)}else l.addOnce(["vast.adEnd","vast.adError"],q);Q.add(N,"scroll",c)},stopAd:function(){this.adManager&&this.adManager.stop()},reset:function(){this.isVPAID=!1;this.adsCanceled=
!0;this.currentAdBreak=null;if(this.adManager)try{this.adUnit=null,this.adManager.destroy(),this.adManager=null}catch(c){BPLR.error("BPLR AdSDK error removing VPAID",c)}},destroyAdsLoader:function(){this.adsLoader=null},getAdDuration:function(){return this.isLinear()&&!isNaN(this.adManager.getAdDuration())&&isFinite(this.adManager.getAdDuration())?this.adManager.getAdDuration():"undefined"!=typeof this._response.duration?this._response.duration:0},getAdCurrentTime:function(){return this.isLinear()?
this.adManager.getAdCurrentTime():0},setAdVolume:function(c){0==this.getAdVolume()&&0!=c?this.tracker&&this.tracker.trackUnmute():0!=this.getAdVolume()&&0==c&&this.tracker&&this.tracker.trackMute();this.adManager&&this.adManager.setAdVolume(c)},getAdVolume:function(){return this.adManager?this.adManager.getAdVolume():0},isLinear:function(){var c=!1;this.isVPAID&&this.adManager&&this.adManager.tech&&this.adManager.tech._adUnit&&!this.adManager.tech._adUnit._creative.getAdLinear()&&(c=!0);return this._response&&
!c?this.currentAdBreak&&"linear"==this.currentAdBreak.breakType||this._response.hasLinear():!1},resize:function(c,p,q,l,r){this.playbackTech&&this.isLinear()&&w.css(this.playbackTech,{height:l+"px"},!1,"important");this.adManager&&this.adManager.resize(c,p,q,l,r)},adError:function(c,p){BPLR.error(c.message,c,p);this._clearAdCancelTimeout();0<this.adsLoader.waterfallAds.length?(this.adCancelTimeoutId=setTimeout(this.$f(function(){this.adError(new E("timeout while waiting for the ad to start playing",
402))}),this.config.adCancelTimeout),this.adsLoader.getVASTResponse(this.adsLoader.waterfallAds.shift(),this.$f(function(q,l){this.adsCanceled||(q?this.adError(q,l):(this._clearAdCancelTimeout(),this._response=l,void 0!==l.adBreaks&&(this.hasAdBreaks=!0,this._playlistResponse=l),this.playAd()))}))):(this.isVPAID=!1,this.adsCanceled=!0,this.trigger("vast.adError",{error:c}))}});N.$bp.plugin("bridparser",function(c,p){});BPLR.event.trigger(O,"bridpluginloaded")})(window,document);
